<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema 360° de seguimiento de prácticas profesionales para la Facultad de Ingenierías - Universidad de Aconcagua">
    <title>Sistema 360° de Prácticas - Facultad de Ingenierías | UAC</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Flatpickr -->
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
    <!-- Select2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" rel="stylesheet" />
    <!-- Leaflet para mapas -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <!-- MarkerCluster para Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    <!-- Estilos personalizados -->
    <style>
        :root {
            --primary-color: #00204e;
            --primary-light: #173b6c;
            --secondary-color: #FFA500;
            --accent-color: #ff8c00;
            --light-bg: #f8f9fa;
            --card-bg: #ffffff;
            --text-color: #333333;
            --muted-text: #6c757d;
            
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            
            --border-radius: 10px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
            color: var(--text-color);
            padding: 0;
            margin: 0;
        }
        
        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .page-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
            color: white;
            padding: 2.5rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .content-wrapper {
            margin: 2rem auto;
        }
        
        /* Card de estudiante */
        .student-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: var(--transition);
            border: none;
        }
        
        .student-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
            transform: translateY(-3px);
        }
        
        .student-card .card-header {
            background-color: var(--primary-color);
            color: white;
            padding: 0.75rem 1.25rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .student-card .card-body {
            padding: 1.5rem;
        }
        
        .student-info {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .student-photo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: var(--primary-color);
        }
        
        .student-details {
            flex: 1;
        }
        
        .student-name {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--primary-color);
        }
        
        .student-id {
            font-size: 1rem;
            color: var(--muted-text);
            margin-bottom: 0.5rem;
        }
        
        .student-career, .student-campus {
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }
        
        .progress-section {
            margin-top: 1.5rem;
        }
        
        .progress-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.5rem;
            display: inline-block;
        }
        
        .progress-bar {
            height: 10px;
            border-radius: 5px;
        }
        
        .stage-badge {
            padding: 0.35rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .stage-not-started {
            background-color: #f8d7da;
            color: var(--danger-color);
        }
        
        .stage-in-progress {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .stage-completed {
            background-color: #d4edda;
            color: var(--success-color);
        }
        
        .status-not-started { color: var(--danger-color); }
        .status-in-progress { color: var(--warning-color); }
        .status-completed { color: var(--success-color); }
        
        .action-buttons {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }
        
        .action-buttons .btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 500;
            transition: var(--transition);
        }
        
        .btn-edit {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        
        .btn-edit:hover {
            background-color: var(--primary-light);
            color: white;
        }
        
        .btn-document {
            background-color: var(--secondary-color);
            color: white;
            border: none;
        }
        
        .btn-document:hover {
            background-color: var(--accent-color);
            color: white;
        }
        
        /* Filtros y búsqueda */
        .filters-section {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-box .form-control {
            padding-left: 40px;
            height: 45px;
            border-radius: 50px;
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--muted-text);
        }
        
        .filter-tag {
            display: inline-flex;
            align-items: center;
            background-color: var(--primary-color);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 50px;
            font-size: 0.85rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .filter-tag .close {
            margin-left: 0.5rem;
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        /* Stats cards */
        .stats-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 1.5rem;
            text-align: center;
            height: 100%;
            transition: var(--transition);
            border: none;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
        }
        
        .stats-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        
        .stats-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }
        
        .stats-label {
            font-size: 1rem;
            color: var(--muted-text);
            margin-bottom: 0.75rem;
        }
        
        .stats-progress {
            height: 8px;
            margin-top: 1rem;
            border-radius: 4px;
        }
        
        /* Modal de edición */
        .modal-header {
            background-color: var(--primary-color);
            color: white;
        }
        
        .modal-body {
            padding: 2rem;
        }
        
        .form-section {
            margin-bottom: 1.5rem;
        }
        
        .form-section-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-color);
            border-bottom: 1px solid #dee2e6;
            padding-bottom: 0.5rem;
        }
        
        .form-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        /* Pagination */
        .pagination-container {
            display: flex;
            justify-content: center;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
        
        .pagination .page-link {
            color: var(--primary-color);
            border-radius: 5px;
            margin: 0 3px;
        }
        
        .pagination .page-item.active .page-link {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        /* Footer */
        .footer {
            background-color: var(--primary-color);
            color: white;
            padding: 1.5rem 0;
            margin-top: 3rem;
        }
        
        /* Tooltip y Popovers */
        .tooltip-inner {
            max-width: 250px;
            padding: 0.5rem 1rem;
            background-color: var(--primary-color);
            font-size: 0.875rem;
        }
        
        /* Animaciones */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Ajustes responsivos */
        @media (max-width: 992px) {
            .student-card .card-body {
                padding: 1.25rem;
            }
            
            .student-photo {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }
            
            .student-name {
                font-size: 1.3rem;
            }
            
            .action-buttons {
                flex-wrap: wrap;
            }
            
            .action-buttons .btn {
                width: 100%;
                justify-content: center;
                margin-bottom: 0.5rem;
            }
        }
        
        @media (max-width: 576px) {
            .student-info {
                flex-direction: column;
                align-items: center;
                text-align: center;
                gap: 1rem;
            }
            
            .student-details {
                width: 100%;
            }
            
            .filters-section .row {
                flex-direction: column;
            }
            
            .filter-dropdown {
                margin-bottom: 1rem;
            }
        }
        
        /* Nota final */
        .final-grade {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 0.4rem 0.75rem;
            display: inline-block;
            margin-top: 0.5rem;
        }
        
        .final-grade.high {
            color: var(--success-color);
        }
        
        .final-grade.medium {
            color: var(--warning-color);
        }
        
        .final-grade.low {
            color: var(--danger-color);
        }
        
        /* Fix para select2 en modales */
        .select2-container--bootstrap-5 {
            z-index: 1056 !important;
        }
        
        /* Estilos para la vista previa de gráficos */
        .chart-preview-container {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .chart-preview-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .chart-canvas-container {
            height: 200px;
            margin-bottom: 10px;
        }
        
        /* Estilos para las opciones tipo encuesta */
        .option-selector {
            margin-bottom: 1.5rem;
        }
        
        .option-selector .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .options-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .option-item {
            position: relative;
            flex: 1;
            min-width: 120px;
        }
        
        .option-item input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .option-item label {
            display: block;
            padding: 0.75rem;
            text-align: center;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            background-color: white;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .option-item:hover label {
            border-color: var(--primary-color);
        }
        
        .option-item input[type="radio"]:checked + label {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        /* Opciones para estados de seguimiento */
        .option-item.status-pending label {
            border-color: var(--danger-color);
            color: var(--danger-color);
        }
        
        .option-item.status-in-progress label {
            border-color: var(--warning-color);
            color: var(--warning-color);
        }
        
        .option-item.status-completed label {
            border-color: var(--success-color);
            color: var(--success-color);
        }
        
        .option-item.status-pending input[type="radio"]:checked + label {
            background-color: var(--danger-color);
            color: white;
        }
        
        .option-item.status-in-progress input[type="radio"]:checked + label {
            background-color: var(--warning-color);
            color: white;
        }
        
        .option-item.status-completed input[type="radio"]:checked + label {
            background-color: var(--success-color);
            color: white;
        }
        
        /* Opciones para evaluación */
        .option-item.eval-excellent label {
            border-color: #28a745;
            color: #28a745;
        }
        
        .option-item.eval-good label {
            border-color: #17a2b8;
            color: #17a2b8;
        }
        
        .option-item.eval-sufficient label {
            border-color: #ffc107;
            color: #ffc107;
        }
        
        .option-item.eval-deficient label {
            border-color: #fd7e14;
            color: #fd7e14;
        }
        
        .option-item.eval-bad label {
            border-color: #dc3545;
            color: #dc3545;
        }
        
        .option-item.eval-excellent input[type="radio"]:checked + label {
            background-color: #28a745;
            color: white;
        }
        
        .option-item.eval-good input[type="radio"]:checked + label {
            background-color: #17a2b8;
            color: white;
        }
        
        .option-item.eval-sufficient input[type="radio"]:checked + label {
            background-color: #ffc107;
            color: white;
        }
        
        .option-item.eval-deficient input[type="radio"]:checked + label {
            background-color: #fd7e14;
            color: white;
        }
        
        .option-item.eval-bad input[type="radio"]:checked + label {
            background-color: #dc3545;
            color: white;
        }
        
        /* Selector de carrera */
        .career-selector {
            margin-bottom: 1.5rem;
        }
        
        .career-selector .form-label {
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .career-options-btn {
            display: block;
            width: 100%;
            padding: 0.75rem;
            text-align: left;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            background-color: white;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }
        
        .career-options-btn:hover {
            border-color: var(--primary-color);
        }
        
        .career-options-btn::after {
            content: '\f107';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .career-selector.active .career-options-btn::after {
            content: '\f106';
        }
        
        .career-selector.selected .career-options-btn {
            border-color: var(--primary-color);
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .career-options-list {
            display: none;
            max-height: 300px;
            overflow-y: auto;
            border: 2px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 8px 8px;
            margin-top: -2px;
        }
        
        .career-selector.active .career-options-list {
            display: block;
        }
        
        .career-option-item {
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .career-option-item:last-child {
            border-bottom: none;
        }
        
        .career-option-item:hover {
            background-color: #f8f9fa;
            color: var(--primary-color);
        }
        
        .career-option-item.selected {
            background-color: var(--primary-color);
            color: white;
        }
        
        /* Selector de sede */
        .campus-selector {
            margin-bottom: 1.5rem;
        }
        
        .campus-options {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .campus-option-item {
            flex: 1;
            min-width: 100px;
            position: relative;
        }
        
        .campus-option-item input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .campus-option-item label {
            display: block;
            padding: 1rem 0.75rem;
            text-align: center;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .campus-option-item:hover label {
            border-color: var(--primary-color);
        }
        
        .campus-option-item input[type="radio"]:checked + label {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        /* Filtros de estado visuales */
        .filter-status-options {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .filter-status-item {
            flex: 1;
            min-width: 100px;
            position: relative;
        }
        
        .filter-status-item input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .filter-status-item label {
            display: block;
            padding: 0.75rem;
            text-align: center;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .filter-status-item.all label {
            border-color: #6c757d;
            color: #6c757d;
        }
        
        .filter-status-item.pending label {
            border-color: var(--danger-color);
            color: var(--danger-color);
        }
        
        .filter-status-item.in-progress label {
            border-color: var(--warning-color);
            color: var(--warning-color);
        }
        
        .filter-status-item.completed label {
            border-color: var(--success-color);
            color: var(--success-color);
        }
        
        .filter-status-item.all input[type="radio"]:checked + label {
            background-color: #6c757d;
            color: white;
        }
        
        .filter-status-item.pending input[type="radio"]:checked + label {
            background-color: var(--danger-color);
            color: white;
        }
        
        .filter-status-item.in-progress input[type="radio"]:checked + label {
            background-color: var(--warning-color);
            color: white;
        }
        
        .filter-status-item.completed input[type="radio"]:checked + label {
            background-color: var(--success-color);
            color: white;
        }
        
        /* Selector de carrera en filtro */
        .filter-career-selector {
            margin-bottom: 1rem;
        }
        
        .filter-career-btn {
            display: block;
            width: 100%;
            padding: 0.75rem;
            text-align: left;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            background-color: white;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }
        
        .filter-career-btn:hover {
            border-color: var(--primary-color);
        }
        
        .filter-career-btn::after {
            content: '\f107';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .filter-career-selector.active .filter-career-btn::after {
            content: '\f106';
        }
        
        .filter-career-selector.selected .filter-career-btn {
            border-color: var(--primary-color);
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .filter-career-options {
            display: none;
            position: absolute;
            width: 100%;
            max-height: 300px;
            overflow-y: auto;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            background-color: white;
            z-index: 1000;
            margin-top: 5px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .filter-career-selector.active .filter-career-options {
            display: block;
        }
        
        .filter-career-option {
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .filter-career-option:last-child {
            border-bottom: none;
        }
        
        .filter-career-option:hover {
            background-color: #f8f9fa;
            color: var(--primary-color);
        }
        
        .filter-career-option.selected {
            background-color: var(--primary-color);
            color: white;
        }

        /* NUEVOS ESTILOS PARA SISTEMA 360° */

        /* Estilo para mapa */
        .map-container {
            height: 500px;
            width: 100%;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .mini-map-container {
            height: 200px;
            width: 100%;
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        /* Estilos para tarjetas de centros de práctica */
        .center-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: var(--transition);
            border: none;
        }

        .center-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
            transform: translateY(-3px);
        }

        .center-card .card-header {
            background-color: var(--primary-color);
            color: white;
            padding: 0.75rem 1.25rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .center-info {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .center-logo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: var(--primary-color);
        }

        .center-details {
            flex: 1;
        }

        .center-name {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--primary-color);
        }

        .center-industry {
            font-size: 1rem;
            color: var(--muted-text);
            margin-bottom: 0.5rem;
        }

        .quality-badge {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-right: 0.5rem;
        }

        .quality-excellent {
            background-color: #d4edda;
            color: var(--success-color);
        }

        .quality-good {
            background-color: #d1ecf1;
            color: #0c5460;
        }

        .quality-average {
            background-color: #fff3cd;
            color: #856404;
        }

        .quality-poor {
            background-color: #f8d7da;
            color: var(--danger-color);
        }

        .impact-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .impact-dots {
            display: flex;
            gap: 3px;
        }

        .impact-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #dee2e6;
        }

        .impact-dot.active {
            background-color: var(--success-color);
        }

        /* Tarjetas de análisis estratégico */
        .strategic-card {
            height: 100%;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 1.5rem;
            transition: var(--transition);
        }

        .strategic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
        }

        .strategic-card-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .strategic-card-body {
            color: var(--text-color);
        }

        /* Pestañas de navegación */
        .nav-tabs .nav-link {
            border: none;
            border-bottom: 3px solid transparent;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            color: var(--text-color);
            transition: var(--transition);
        }

        .nav-tabs .nav-link:hover {
            border-color: var(--secondary-color);
            background-color: transparent;
        }

        .nav-tabs .nav-link.active {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background-color: transparent;
        }

        /* Tablero de indicadores */
        .dashboard-item {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 1.5rem;
            text-align: center;
            height: 100%;
            transition: var(--transition);
        }

        .dashboard-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
        }

        .dashboard-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .dashboard-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .dashboard-label {
            font-size: 0.9rem;
            color: var(--muted-text);
        }

        /* Selector de industria */
        .industry-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .industry-item {
            position: relative;
            flex: 1;
            min-width: 120px;
        }

        .industry-item input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .industry-item label {
            display: block;
            padding: 0.75rem;
            text-align: center;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .industry-item:hover label {
            border-color: var(--primary-color);
        }

        .industry-item input[type="checkbox"]:checked + label {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Tarjetas de retroalimentación */
        .feedback-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--primary-color);
        }

        .feedback-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .feedback-title {
            font-weight: 600;
            color: var(--primary-color);
        }

        .feedback-date {
            font-size: 0.9rem;
            color: var(--muted-text);
        }

        .feedback-content {
            margin-bottom: 1rem;
        }

        .feedback-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
        }

        /* Tooltip map */
        .map-tooltip {
            padding: 0.5rem;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            border: 1px solid #dee2e6;
            font-size: 0.9rem;
        }

        .map-tooltip-title {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .map-tooltip-content {
            color: var(--text-color);
        }

        /* Heat scale */
        .heat-scale {
            display: flex;
            align-items: center;
            margin-top: 1rem;
        }

        .heat-scale-label {
            font-size: 0.85rem;
            color: var(--muted-text);
            margin-right: 0.5rem;
        }

        .heat-scale-bars {
            display: flex;
            flex: 1;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }

        .heat-bar {
            height: 100%;
        }

        .heat-bar-1 { background-color: #c6efce; width: 20%; }
        .heat-bar-2 { background-color: #b7e1cd; width: 20%; }
        .heat-bar-3 { background-color: #fce8b2; width: 20%; }
        .heat-bar-4 { background-color: #f8cbad; width: 20%; }
        .heat-bar-5 { background-color: #f4b084; width: 20%; }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="fas fa-university me-2"></i>Seguimiento 360° Prácticas UAC
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link">
                            <i class="fas fa-home me-1"></i> Inicio
                        </a>
                    </li>
                    <li class="nav-item">
                        <button id="logoutBtn" class="btn btn-danger ms-2">
                            <i class="fas fa-sign-out-alt me-1"></i> Cerrar Sesión
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <header class="page-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1><i class="fas fa-cogs me-2"></i> Sistema 360° de Prácticas</h1>
                    <p class="lead">Facultad de Ingenierías, Tecnologías e Innovación</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <a href="index.html" id="volverPrincipal" class="btn btn-light">
                        <i class="fas fa-arrow-left me-1"></i> Volver al Menú
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container content-wrapper">
        <!-- Pestañas de navegación principal -->
        <ul class="nav nav-tabs mb-4" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="students-tab" data-bs-toggle="tab" data-bs-target="#students-content" type="button" role="tab">
                    <i class="fas fa-user-graduate me-1"></i> Estudiantes
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="centers-tab" data-bs-toggle="tab" data-bs-target="#centers-content" type="button" role="tab">
                    <i class="fas fa-building me-1"></i> Centros de Práctica
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="strategic-tab" data-bs-toggle="tab" data-bs-target="#strategic-content" type="button" role="tab">
                    <i class="fas fa-chart-line me-1"></i> Análisis Estratégico
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="feedback-tab" data-bs-toggle="tab" data-bs-target="#feedback-content" type="button" role="tab">
                    <i class="fas fa-exchange-alt me-1"></i> Retroalimentación
                </button>
            </li>
        </ul>
        
        <!-- Contenido de las pestañas -->
        <div class="tab-content" id="mainTabsContent">
            <!-- Pestaña de Estudiantes -->
            <div class="tab-pane fade show active" id="students-content" role="tabpanel">
                <!-- Estadísticas generales -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h2 class="mb-4"><i class="fas fa-chart-simple me-2"></i> Estadísticas Generales</h2>
                    </div>
                    
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="stats-card">
                            <div class="stats-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stats-value" id="totalStudentsValue">0</div>
                            <div class="stats-label">Estudiantes en Prácticas</div>
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="stats-card">
                            <div class="stats-icon text-warning">
                                <i class="fas fa-spinner"></i>
                            </div>
                            <div class="stats-value text-warning" id="inProgressValue">0</div>
                            <div class="stats-label">En Proceso</div>
                            <div class="progress stats-progress">
                                <div class="progress-bar bg-warning" id="inProgressBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="stats-card">
                            <div class="stats-icon text-success">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stats-value text-success" id="completedValue">0</div>
                            <div class="stats-label">Completadas</div>
                            <div class="progress stats-progress">
                                <div class="progress-bar bg-success" id="completedBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="stats-card">
                            <div class="stats-icon text-danger">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stats-value text-danger" id="pendingValue">0</div>
                            <div class="stats-label">Pendientes</div>
                            <div class="progress stats-progress">
                                <div class="progress-bar bg-danger" id="pendingBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Botones de acción generales -->
                    <div class="col-12 text-center mt-2 mb-4">
                        <button id="generateReportBtn" class="btn btn-primary me-2">
                            <i class="fas fa-file-pdf me-1"></i> Generar Informe Completo
                        </button>
                        <button id="exportExcelBtn" class="btn btn-success me-2">
                            <i class="fas fa-file-excel me-1"></i> Exportar a Excel
                        </button>
                        <button id="addStudentBtn" class="btn btn-secondary">
                            <i class="fas fa-user-plus me-1"></i> Agregar Estudiante
                        </button>
                    </div>
                </div>
                
                <!-- Filtros y búsqueda -->
                <div class="filters-section">
                    <div class="row">
                        <div class="col-md-6 mb-3 mb-md-0">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" id="searchStudent" class="form-control" placeholder="Buscar por nombre, RUT o centro de práctica...">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="row">
                                <div class="col-md-6 mb-3 mb-md-0">
                                    <!-- Selector visual de carrera -->
                                    <div class="filter-career-selector" id="filterCareerSelector">
                                        <div class="filter-career-btn" id="filterCareerBtn">
                                            Todas las carreras
                                        </div>
                                        <div class="filter-career-options" id="filterCareerOptions">
                                            <div class="filter-career-option selected" data-value="">Todas las carreras</div>
                                            <!-- Las opciones se cargarán dinámicamente -->
                                        </div>
                                        <input type="hidden" id="filterCareer" value="">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <!-- Opciones visuales de estado -->
                                    <div class="filter-status-options">
                                        <div class="filter-status-item all">
                                            <input type="radio" name="filterStatus" id="filterStatusAll" value="" checked>
                                            <label for="filterStatusAll">Todos</label>
                                        </div>
                                        <div class="filter-status-item pending">
                                            <input type="radio" name="filterStatus" id="filterStatusPending" value="no-comienza">
                                            <label for="filterStatusPending">Pendiente</label>
                                        </div>
                                        <div class="filter-status-item in-progress">
                                            <input type="radio" name="filterStatus" id="filterStatusInProgress" value="en-proceso">
                                            <label for="filterStatusInProgress">En Proceso</label>
                                        </div>
                                        <div class="filter-status-item completed">
                                            <input type="radio" name="filterStatus" id="filterStatusCompleted" value="completada">
                                            <label for="filterStatusCompleted">Completada</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3" id="activeFilters">
                        <!-- Etiquetas de filtros activos se cargarán aquí -->
                    </div>
                </div>
                
                <!-- Listado de estudiantes -->
                <div id="studentsList" class="mt-4">
                    <!-- Las tarjetas se generarán dinámicamente -->
                </div>
                
                <!-- Paginación -->
                <div class="pagination-container">
                    <nav aria-label="Navegación de páginas">
                        <ul class="pagination" id="pagination">
                            <!-- La paginación se generará dinámicamente -->
                        </ul>
                    </nav>
                </div>
            </div>
            
            <!-- Pestaña de Centros de Práctica -->
            <div class="tab-pane fade" id="centers-content" role="tabpanel">
                <!-- Dashboard de centros de práctica -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h2 class="mb-4"><i class="fas fa-building me-2"></i> Centros de Práctica</h2>
                    </div>
                    
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="dashboard-item">
                            <div class="dashboard-icon">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="dashboard-value" id="totalCentersValue">0</div>
                            <div class="dashboard-label">Centros de Práctica</div>
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="dashboard-item">
                            <div class="dashboard-icon text-success">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="dashboard-value text-success" id="highQualityValue">0</div>
                            <div class="dashboard-label">Alta Pertinencia</div>
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="dashboard-item">
                            <div class="dashboard-icon" style="color: #17a2b8;">
                                <i class="fas fa-handshake"></i>
                            </div>
                            <div class="dashboard-value" style="color: #17a2b8;" id="strategicValue">0</div>
                            <div class="dashboard-label">Alianzas Estratégicas</div>
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="dashboard-item">
                            <div class="dashboard-icon" style="color: #fd7e14;">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="dashboard-value" style="color: #fd7e14;" id="regionsValue">0</div>
                            <div class="dashboard-label">Regiones Cubiertas</div>
                        </div>
                    </div>
                    
                    <!-- Botones de acción para centros -->
                    <div class="col-12 text-center mt-2 mb-4">
                        <button id="addCenterBtn" class="btn btn-primary me-2">
                            <i class="fas fa-plus-circle me-1"></i> Agregar Centro de Práctica
                        </button>
                        <button id="exportCentersBtn" class="btn btn-success me-2">
                            <i class="fas fa-file-excel me-1"></i> Exportar Datos
                        </button>
                        <button id="generateCentersReportBtn" class="btn btn-secondary">
                            <i class="fas fa-chart-pie me-1"></i> Generar Análisis
                        </button>
                    </div>
                </div>
                
                <!-- Mapa de centros de práctica -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h3 class="mb-3"><i class="fas fa-map-marked-alt me-2"></i> Georreferenciación</h3>
                        <div class="map-container" id="centersMap">
                            <!-- El mapa se cargará aquí -->
                        </div>
                        <div class="d-flex justify-content-center align-items-center mt-2">
                            <div class="me-4">
                                <span class="badge bg-success me-1">●</span> Alta Pertinencia
                            </div>
                            <div class="me-4">
                                <span class="badge bg-primary me-1">●</span> Media Pertinencia
                            </div>
                            <div class="me-4">
                                <span class="badge bg-warning me-1">●</span> Baja Pertinencia
                            </div>
                            <div>
                                <span class="badge bg-danger me-1">●</span> Sin Evaluación
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Filtros para centros de práctica -->
                <div class="filters-section mb-4">
                    <div class="row">
                        <div class="col-md-6 mb-3 mb-md-0">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" id="searchCenter" class="form-control" placeholder="Buscar por nombre, sector o ubicación...">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="row">
                                <div class="col-md-6 mb-3 mb-md-0">
                                    <select class="form-select" id="filterQuality">
                                        <option value="">Todas las calificaciones</option>
                                        <option value="alta">Alta Pertinencia</option>
                                        <option value="media">Media Pertinencia</option>
                                        <option value="baja">Baja Pertinencia</option>
                                        <option value="sin-evaluacion">Sin Evaluación</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <select class="form-select" id="filterImpact">
                                        <option value="">Todos los niveles de impacto</option>
                                        <option value="alto">Alto Impacto Estratégico</option>
                                        <option value="medio">Medio Impacto Estratégico</option>
                                        <option value="bajo">Bajo Impacto Estratégico</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <h6 class="mb-2">Filtrar por sector industrial:</h6>
                        <div class="industry-filter" id="industryFilter">
                            <!-- Opciones de filtro por sector industrial -->
                            <div class="industry-item">
                                <input type="checkbox" id="industryAll" value="all" checked>
                                <label for="industryAll">Todos</label>
                            </div>
                            <div class="industry-item">
                                <input type="checkbox" id="industryMineria" value="mineria">
                                <label for="industryMineria">Minería</label>
                            </div>
                            <div class="industry-item">
                                <input type="checkbox" id="industryTecnologia" value="tecnologia">
                                <label for="industryTecnologia">Tecnología</label>
                            </div>
                            <div class="industry-item">
                                <input type="checkbox" id="industryManufactura" value="industria">
                                <label for="industryManufactura">Manufactura</label>
                            </div>
                            <div class="industry-item">
                                <input type="checkbox" id="industryServicios" value="servicios">
                                <label for="industryServicios">Servicios</label>
                            </div>
                            <div class="industry-item">
                                <input type="checkbox" id="industryComercio" value="comercio">
                                <label for="industryComercio">Comercio</label>
                            </div>
                            <div class="industry-item">
                                <input type="checkbox" id="industryOtros" value="otro">
                                <label for="industryOtros">Otros</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Listado de centros de práctica -->
                <div id="centersList" class="mt-4">
                    <!-- Las tarjetas se generarán dinámicamente -->
                </div>
                
                <!-- Paginación para centros -->
                <div class="pagination-container">
                    <nav aria-label="Navegación de páginas">
                        <ul class="pagination" id="centersPagination">
                            <!-- La paginación se generará dinámicamente -->
                        </ul>
                    </nav>
                </div>
            </div>
            
            <!-- Pestaña de Análisis Estratégico -->
            <div class="tab-pane fade" id="strategic-content" role="tabpanel">
                <div class="row mb-4">
                    <div class="col-12">
                        <h2 class="mb-4"><i class="fas fa-chart-line me-2"></i> Análisis Estratégico</h2>
                    </div>
                </div>
                
                <!-- Indicadores clave -->
                <div class="row mb-4">
                    <div class="col-md-3 mb-4">
                        <div class="strategic-card">
                            <div class="strategic-card-title">
                                <i class="fas fa-percentage"></i> Tasa de Colocación
                            </div>
                            <div class="strategic-card-body">
                                <div class="dashboard-value" id="placementRateValue">0%</div>
                                <div class="progress mt-2">
                                    <div class="progress-bar bg-success" id="placementRateBar" style="width: 0%"></div>
                                </div>
                                <div class="mt-2 text-muted">Estudiantes colocados en prácticas vs. total de postulantes</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3 mb-4">
                        <div class="strategic-card">
                            <div class="strategic-card-title">
                                <i class="fas fa-briefcase"></i> Empleabilidad
                            </div>
                            <div class="strategic-card-body">
                                <div class="dashboard-value" id="employabilityValue">0%</div>
                                <div class="progress mt-2">
                                    <div class="progress-bar bg-primary" id="employabilityBar" style="width: 0%"></div>
                                </div>
                                <div class="mt-2 text-muted">Estudiantes contratados tras finalizar prácticas</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3 mb-4">
                        <div class="strategic-card">
                            <div class="strategic-card-title">
                                <i class="fas fa-thumbs-up"></i> Satisfacción
                            </div>
                            <div class="strategic-card-body">
                                <div class="dashboard-value" id="satisfactionValue">0%</div>
                                <div class="progress mt-2">
                                    <div class="progress-bar" style="background-color: #17a2b8; width: 0%" id="satisfactionBar"></div>
                                </div>
                                <div class="mt-2 text-muted">Nivel de satisfacción general con prácticas</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-3 mb-4">
                        <div class="strategic-card">
                            <div class="strategic-card-title">
                                <i class="fas fa-handshake"></i> Alianzas
                            </div>
                            <div class="strategic-card-body">
                                <div class="dashboard-value" id="allianceCountValue">0</div>
                                <div class="d-flex justify-content-center mt-2">
                                    <div class="impact-dots">
                                        <div class="impact-dot active"></div>
                                        <div class="impact-dot active"></div>
                                        <div class="impact-dot active"></div>
                                        <div class="impact-dot"></div>
                                        <div class="impact-dot"></div>
                                    </div>
                                </div>
                                <div class="mt-2 text-muted">Centros con convenios formales</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Gráficos y métricas -->
                <div class="row mb-4">
                    <!-- Distribución por Sector Industrial -->
                    <div class="col-md-6 mb-4">
                        <div class="chart-preview-container">
                            <h5 class="chart-preview-title"><i class="fas fa-industry me-2"></i> Distribución por Sector Industrial</h5>
                            <div class="chart-canvas-container">
                                <canvas id="sectorDistributionChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Distribución por Nivel de Pertinencia -->
                    <div class="col-md-6 mb-4">
                        <div class="chart-preview-container">
                            <h5 class="chart-preview-title"><i class="fas fa-check-circle me-2"></i> Distribución por Nivel de Pertinencia</h5>
                            <div class="chart-canvas-container">
                                <canvas id="relevanceDistributionChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Distribución Geográfica -->
                    <div class="col-md-6 mb-4">
                        <div class="chart-preview-container">
                            <h5 class="chart-preview-title"><i class="fas fa-map-marker-alt me-2"></i> Distribución Geográfica</h5>
                            <div class="chart-canvas-container">
                                <canvas id="geographicDistributionChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Evolución Temporal -->
                    <div class="col-md-6 mb-4">
                        <div class="chart-preview-container">
                            <h5 class="chart-preview-title"><i class="fas fa-chart-line me-2"></i> Evolución Temporal</h5>
                            <div class="chart-canvas-container">
                                <canvas id="temporalEvolutionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Recomendaciones estratégicas -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h3 class="mb-3"><i class="fas fa-lightbulb me-2"></i> Recomendaciones Estratégicas</h3>
                    </div>
                    
                    <div class="col-md-6 mb-4">
                        <div class="strategic-card">
                            <div class="strategic-card-title">
                                <i class="fas fa-star me-2"></i> Centros de Alta Prioridad
                            </div>
                            <div class="strategic-card-body">
                                <p>Estos centros de práctica han mostrado alta pertinencia y potencial estratégico. Se recomienda formalizar o fortalecer alianzas.</p>
                                <div id="highPriorityCentersList">
                                    <div class="alert alert-light text-center">
                                        <i class="fas fa-info-circle me-2"></i> Cargando recomendaciones...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mb-4">
                        <div class="strategic-card">
                            <div class="strategic-card-title">
                                <i class="fas fa-map-marked me-2"></i> Áreas Geográficas a Desarrollar
                            </div>
                            <div class="strategic-card-body">
                                <p>Estas regiones tienen baja cobertura de centros de práctica y representan oportunidades de expansión para la UAC.</p>
                                <div id="geographicRecommendationsList">
                                    <div class="alert alert-light text-center">
                                        <i class="fas fa-info-circle me-2"></i> Cargando recomendaciones...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mb-4">
                        <div class="strategic-card">
                            <div class="strategic-card-title">
                                <i class="fas fa-industry me-2"></i> Sectores Industriales a Fortalecer
                            </div>
                            <div class="strategic-card-body">
                                <p>Estos sectores son relevantes para las carreras UAC pero tienen baja representación en nuestros centros de práctica.</p>
                                <div id="industryRecommendationsList">
                                    <div class="alert alert-light text-center">
                                        <i class="fas fa-info-circle me-2"></i> Cargando recomendaciones...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mb-4">
                        <div class="strategic-card">
                            <div class="strategic-card-title">
                                <i class="fas fa-handshake me-2"></i> Oportunidades de Colaboración
                            </div>
                            <div class="strategic-card-body">
                                <p>Basado en feedback y evaluaciones, estas empresas tienen alto potencial para colaboraciones más allá de prácticas.</p>
                                <div id="collaborationRecommendationsList">
                                    <div class="alert alert-light text-center">
                                        <i class="fas fa-info-circle me-2"></i> Cargando recomendaciones...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pestaña de Retroalimentación -->
            <div class="tab-pane fade" id="feedback-content" role="tabpanel">
                <div class="row mb-4">
                    <div class="col-12">
                        <h2 class="mb-4"><i class="fas fa-exchange-alt me-2"></i> Sistema de Retroalimentación Bidireccional</h2>
                    </div>
                </div>
                
                <!-- Pestañas secundarias para retroalimentación -->
                <ul class="nav nav-tabs mb-4" id="feedbackTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="uac-feedback-tab" data-bs-toggle="tab" data-bs-target="#uac-feedback" type="button" role="tab">
                            <i class="fas fa-university me-1"></i> UAC → Centros
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="center-feedback-tab" data-bs-toggle="tab" data-bs-target="#center-feedback" type="button" role="tab">
                            <i class="fas fa-building me-1"></i> Centros → UAC
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="student-feedback-tab" data-bs-toggle="tab" data-bs-target="#student-feedback" type="button" role="tab">
                            <i class="fas fa-user-graduate me-1"></i> Estudiantes
                        </button>
                    </li>
                </ul>
                
                <!-- Contenido de pestañas de retroalimentación -->
                <div class="tab-content" id="feedbackTabsContent">
                    <!-- UAC a Centros -->
                    <div class="tab-pane fade show active" id="uac-feedback" role="tabpanel">
                        <div class="row mb-4">
                            <div class="col-md-4 mb-3">
                                <div class="search-box">
                                    <i class="fas fa-search search-icon"></i>
                                    <input type="text" id="searchUacFeedback" class="form-control" placeholder="Buscar por centro o fecha...">
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <select class="form-select" id="filterUacFeedbackCenter">
                                    <option value="">Todos los centros</option>
                                    <!-- Opciones se cargarán dinámicamente -->
                                </select>
                            </div>
                            <div class="col-md-4 text-md-end">
                                <button id="newUacFeedbackBtn" class="btn btn-primary">
                                    <i class="fas fa-plus-circle me-1"></i> Nueva Retroalimentación
                                </button>
                            </div>
                        </div>
                        
                        <div id="uacFeedbackList">
                            <!-- La lista se generará dinámicamente -->
                        </div>
                        
                        <!-- Paginación -->
                        <div class="pagination-container">
                            <nav aria-label="Navegación de páginas">
                                <ul class="pagination" id="uacFeedbackPagination">
                                    <!-- La paginación se generará dinámicamente -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                    
                    <!-- Centros a UAC -->
                    <div class="tab-pane fade" id="center-feedback" role="tabpanel">
                        <div class="row mb-4">
                            <div class="col-md-4 mb-3">
                                <div class="search-box">
                                    <i class="fas fa-search search-icon"></i>
                                    <input type="text" id="searchCenterFeedback" class="form-control" placeholder="Buscar por centro o fecha...">
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <select class="form-select" id="filterCenterFeedbackType">
                                    <option value="">Todos los tipos</option>
                                    <option value="comentario">Comentario</option>
                                    <option value="sugerencia">Sugerencia</option>
                                    <option value="evaluacion">Evaluación</option>
                                </select>
                            </div>
                            <div class="col-md-4 text-md-end">
                                <button id="requestCenterFeedbackBtn" class="btn btn-primary">
                                    <i class="fas fa-paper-plane me-1"></i> Solicitar Retroalimentación
                                </button>
                            </div>
                        </div>
                        
                        <div id="centerFeedbackList">
                            <!-- La lista se generará dinámicamente -->
                        </div>
                        
                        <!-- Paginación -->
                        <div class="pagination-container">
                            <nav aria-label="Navegación de páginas">
                                <ul class="pagination" id="centerFeedbackPagination">
                                    <!-- La paginación se generará dinámicamente -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                    
                    <!-- Estudiantes -->
                    <div class="tab-pane fade" id="student-feedback" role="tabpanel">
                        <div class="row mb-4">
                            <div class="col-md-4 mb-3">
                                <div class="search-box">
                                    <i class="fas fa-search search-icon"></i>
                                    <input type="text" id="searchStudentFeedback" class="form-control" placeholder="Buscar por estudiante o centro...">
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <select class="form-select" id="filterStudentFeedbackCenter">
                                    <option value="">Todos los centros</option>
                                    <!-- Opciones se cargarán dinámicamente -->
                                </select>
                            </div>
                            <div class="col-md-4 text-md-end">
                                <button id="requestStudentFeedbackBtn" class="btn btn-primary">
                                    <i class="fas fa-paper-plane me-1"></i> Solicitar Evaluación
                                </button>
                            </div>
                        </div>
                        
                        <div id="studentFeedbackList">
                            <!-- La lista se generará dinámicamente -->
                        </div>
                        
                        <!-- Paginación -->
                        <div class="pagination-container">
                            <nav aria-label="Navegación de páginas">
                                <ul class="pagination" id="studentFeedbackPagination">
                                    <!-- La paginación se generará dinámicamente -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal para editar estudiante -->
    <div class="modal fade" id="editStudentModal" tabindex="-1" aria-labelledby="editStudentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editStudentModalLabel">Editar Información del Estudiante</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="editStudentForm">
                        <input type="hidden" id="studentId">
                        
                        <!-- Información personal -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-user me-2"></i>Información Personal</h5>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="studentName" class="form-label">Nombre completo</label>
                                    <input type="text" class="form-control" id="studentName" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="studentRut" class="form-label">RUT</label>
                                    <input type="text" class="form-control" id="studentRut" required>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <!-- Selector visual de carrera -->
                                    <div class="career-selector" id="careerSelector">
                                        <label class="form-label">Carrera</label>
                                        <div class="career-options-btn" id="careerOptionsBtn">Seleccionar carrera</div>
                                        <div class="career-options-list" id="careerOptionsList">
                                            <!-- Las opciones se cargarán dinámicamente -->
                                        </div>
                                        <input type="hidden" id="studentCareer" required>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <!-- Opciones visuales de sede -->
                                    <div class="campus-selector">
                                        <label class="form-label">Sede</label>
                                        <div class="campus-options" id="campusOptions">
                                            <!-- Las opciones se cargarán dinámicamente -->
                                        </div>
                                        <input type="hidden" id="studentCampus" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Información de práctica -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-building me-2"></i>Información de Práctica</h5>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="practiceSupervisor" class="form-label">Encargado práctica UAC</label>
                                    <div class="option-selector">
                                        <div class="options-container">
                                            <div class="option-item">
                                                <input type="radio" name="practiceSupervisorType" id="practiceSupervisorDirectorAcademico" value="Director/a Académico/a">
                                                <label for="practiceSupervisorDirectorAcademico">Director/a Académico/a</label>
                                            </div>
                                            <div class="option-item">
                                                <input type="radio" name="practiceSupervisorType" id="practiceSupervisorDirectorCarrera" value="Director/a de Carrera">
                                                <label for="practiceSupervisorDirectorCarrera">Director/a de Carrera</label>
                                            </div>
                                            <div class="option-item">
                                                <input type="radio" name="practiceSupervisorType" id="practiceSupervisorTutorVirtual" value="Tutor/a Virtual">
                                                <label for="practiceSupervisorTutorVirtual">Tutor/a Virtual</label>
                                            </div>
                                            <div class="option-item">
                                                <input type="radio" name="practiceSupervisorType" id="practiceSupervisorDocente" value="Docente">
                                                <label for="practiceSupervisorDocente">Docente</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="practiceSupervisor" required>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="practiceCenter" class="form-label">Centro de práctica</label>
                                    <select class="form-select" id="practiceCenter" required>
                                        <option value="" selected disabled>Seleccionar centro</option>
                                        <!-- Opciones se cargarán dinámicamente -->
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="practiceInstructor" class="form-label">Instructor</label>
                                    <input type="text" class="form-control" id="practiceInstructor" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <!-- Opciones visuales de estado de práctica -->
                                    <div class="option-selector">
                                        <label class="form-label">Estado de la práctica</label>
                                        <div class="options-container">
                                            <div class="option-item status-pending">
                                                <input type="radio" name="practiceState" id="practiceStatePending" value="no-comienza">
                                                <label for="practiceStatePending">No comienza</label>
                                            </div>
                                            <div class="option-item status-in-progress">
                                                <input type="radio" name="practiceState" id="practiceStateInProgress" value="en-proceso">
                                                <label for="practiceStateInProgress">En proceso</label>
                                            </div>
                                            <div class="option-item status-completed">
                                                <input type="radio" name="practiceState" id="practiceStateCompleted" value="completada">
                                                <label for="practiceStateCompleted">Completada</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="practiceState" required>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label class="form-label">Instrumento Metodológico</label>
                                    <div class="option-selector">
                                        <div class="options-container">
                                            <div class="option-item">
                                                <input type="radio" name="instrumentoMetodologico" id="instrumentoTesis" value="Tesis">
                                                <label for="instrumentoTesis">Tesis</label>
                                            </div>
                                            <div class="option-item">
                                                <input type="radio" name="instrumentoMetodologico" id="instrumentoTesina" value="Tesina">
                                                <label for="instrumentoTesina">Tesina</label>
                                            </div>
                                            <div class="option-item">
                                                <input type="radio" name="instrumentoMetodologico" id="instrumentoPlanMejora" value="Plan de mejora">
                                                <label for="instrumentoPlanMejora">Plan de mejora</label>
                                            </div>
                                            <div class="option-item">
                                                <input type="radio" name="instrumentoMetodologico" id="instrumentoInforme" value="Informe de Practica">
                                                <label for="instrumentoInforme">Informe de Practica</label>
                                            </div>
                                            <div class="option-item">
                                                <input type="radio" name="instrumentoMetodologico" id="instrumentoIntegradora1" value="Asignatura Integradora 1">
                                                <label for="instrumentoIntegradora1">Asignatura Integradora 1</label>
                                            </div>
                                            <div class="option-item">
                                                <input type="radio" name="instrumentoMetodologico" id="instrumentoIntegradora2" value="Asignatura Integradora 2">
                                                <label for="instrumentoIntegradora2">Asignatura Integradora 2</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="instrumentoMetodologicoValue" required>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="startDate" class="form-label">Fecha de inicio</label>
                                    <input type="text" class="form-control datepicker" id="startDate">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="endDate" class="form-label">Fecha de término</label>
                                    <input type="text" class="form-control datepicker" id="endDate">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Seguimiento y evaluación -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-tasks me-2"></i>Seguimiento y Evaluación</h5>
                            
                            <!-- Opciones visuales de Seguimiento 1 -->
                            <div class="option-selector">
                                <label class="form-label">Seguimiento 1</label>
                                <div class="options-container">
                                    <div class="option-item status-pending">
                                        <input type="radio" name="tracking1" id="tracking1Pending" value="no-comienza">
                                        <label for="tracking1Pending">No comienza</label>
                                    </div>
                                    <div class="option-item status-in-progress">
                                        <input type="radio" name="tracking1" id="tracking1InProgress" value="en-proceso">
                                        <label for="tracking1InProgress">En proceso</label>
                                    </div>
                                    <div class="option-item status-completed">
                                        <input type="radio" name="tracking1" id="tracking1Completed" value="completada">
                                        <label for="tracking1Completed">Completada</label>
                                    </div>
                                </div>
                                <input type="hidden" id="tracking1">
                            </div>
                            
                            <!-- Opciones visuales de Evaluación parcial -->
                            <div class="option-selector">
                                <label class="form-label">Evaluación parcial</label>
                                <div class="options-container">
                                    <div class="option-item eval-excellent">
                                        <input type="radio" name="partialEvaluation" id="partialEvalExcellent" value="excelente">
                                        <label for="partialEvalExcellent">Excelente</label>
                                    </div>
                                    <div class="option-item eval-good">
                                        <input type="radio" name="partialEvaluation" id="partialEvalGood" value="bien">
                                        <label for="partialEvalGood">Bien</label>
                                    </div>
                                    <div class="option-item eval-sufficient">
                                        <input type="radio" name="partialEvaluation" id="partialEvalSufficient" value="suficiente">
                                        <label for="partialEvalSufficient">Suficiente</label>
                                    </div>
                                    <div class="option-item eval-deficient">
                                        <input type="radio" name="partialEvaluation" id="partialEvalDeficient" value="deficiente">
                                        <label for="partialEvalDeficient">Deficiente</label>
                                    </div>
                                    <div class="option-item eval-bad">
                                        <input type="radio" name="partialEvaluation" id="partialEvalBad" value="malo">
                                        <label for="partialEvalBad">Malo</label>
                                    </div>
                                </div>
                                <input type="hidden" id="partialEvaluation">
                            </div>
                            
                            <!-- Opciones visuales de Seguimiento 2 -->
                            <div class="option-selector">
                                <label class="form-label">Seguimiento 2</label>
                                <div class="options-container">
                                    <div class="option-item status-pending">
                                        <input type="radio" name="tracking2" id="tracking2Pending" value="no-comienza">
                                        <label for="tracking2Pending">No comienza</label>
                                    </div>
                                    <div class="option-item status-in-progress">
                                        <input type="radio" name="tracking2" id="tracking2InProgress" value="en-proceso">
                                        <label for="tracking2InProgress">En proceso</label>
                                    </div>
                                    <div class="option-item status-completed">
                                        <input type="radio" name="tracking2" id="tracking2Completed" value="completada">
                                        <label for="tracking2Completed">Completada</label>
                                    </div>
                                </div>
                                <input type="hidden" id="tracking2">
                            </div>
                            
                            <!-- Opciones visuales de Revisión de avance -->
                            <div class="option-selector">
                                <label class="form-label">Revisión de avance</label>
                                <div class="options-container">
                                    <div class="option-item eval-excellent">
                                        <input type="radio" name="progressReview" id="progressReviewExcellent" value="excelente">
                                        <label for="progressReviewExcellent">Excelente</label>
                                    </div>
                                    <div class="option-item eval-good">
                                        <input type="radio" name="progressReview" id="progressReviewGood" value="bien">
                                        <label for="progressReviewGood">Bien</label>
                                    </div>
                                    <div class="option-item eval-sufficient">
                                        <input type="radio" name="progressReview" id="progressReviewSufficient" value="suficiente">
                                        <label for="progressReviewSufficient">Suficiente</label>
                                    </div>
                                    <div class="option-item eval-deficient">
                                        <input type="radio" name="progressReview" id="progressReviewDeficient" value="deficiente">
                                        <label for="progressReviewDeficient">Deficiente</label>
                                    </div>
                                    <div class="option-item eval-bad">
                                        <input type="radio" name="progressReview" id="progressReviewBad" value="malo">
                                        <label for="progressReviewBad">Malo</label>
                                    </div>
                                </div>
                                <input type="hidden" id="progressReview">
                            </div>
                            
                            <!-- Opciones visuales de Evaluación instructor -->
                            <div class="option-selector">
                                <label class="form-label">Evaluación instructor</label>
                                <div class="options-container">
                                    <div class="option-item eval-excellent">
                                        <input type="radio" name="instructorEvaluation" id="instructorEvalExcellent" value="excelente">
                                        <label for="instructorEvalExcellent">Excelente</label>
                                    </div>
                                    <div class="option-item eval-good">
                                        <input type="radio" name="instructorEvaluation" id="instructorEvalGood" value="bien">
                                        <label for="instructorEvalGood">Bien</label>
                                    </div>
                                    <div class="option-item eval-sufficient">
                                        <input type="radio" name="instructorEvaluation" id="instructorEvalSufficient" value="suficiente">
                                        <label for="instructorEvalSufficient">Suficiente</label>
                                    </div>
                                    <div class="option-item eval-deficient">
                                        <input type="radio" name="instructorEvaluation" id="instructorEvalDeficient" value="deficiente">
                                        <label for="instructorEvalDeficient">Deficiente</label>
                                    </div>
                                    <div class="option-item eval-bad">
                                        <input type="radio" name="instructorEvaluation" id="instructorEvalBad" value="malo">
                                        <label for="instructorEvalBad">Malo</label>
                                    </div>
                                </div>
                                <input type="hidden" id="instructorEvaluation">
                            </div>
                            
                            <!-- Opciones visuales de Asignación hora examen -->
                            <div class="option-selector">
                                <label class="form-label">Asignación hora examen</label>
                                <div class="options-container">
                                    <div class="option-item status-pending">
                                        <input type="radio" name="examAssignment" id="examAssignmentPending" value="no-comienza">
                                        <label for="examAssignmentPending">No comienza</label>
                                    </div>
                                    <div class="option-item status-in-progress">
                                        <input type="radio" name="examAssignment" id="examAssignmentInProgress" value="en-proceso">
                                        <label for="examAssignmentInProgress">En proceso</label>
                                    </div>
                                    <div class="option-item status-completed">
                                        <input type="radio" name="examAssignment" id="examAssignmentCompleted" value="completada">
                                        <label for="examAssignmentCompleted">Completada</label>
                                    </div>
                                </div>
                                <input type="hidden" id="examAssignment">
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="researchLine" class="form-label">Lineas de Investigación</label>
                                    <select class="form-select" id="researchLine">
                                        <option value="" disabled selected>Seleccione una línea</option>
                                        <option value="industrias">Escuela de Industrias: "Transformación Industrial Inteligente: Integración de Tecnologías 4.0 y Optimización de Procesos Productivos"</option>
                                        <option value="mineria">Escuela de Mineria: "Minería Sustentable y Tecnológica: Integración de Innovación, Seguridad, inclusión y Desarrollo Social"</option>
                                        <option value="negocios">Escuela de Negocios: "Transformación Digital y Sostenibilidad en la Gestión Empresarial: Innovación y Competitividad en Mercados Globalizados"</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="finalGrade" class="form-label">Nota Final (1.0 - 7.0)</label>
                                    <input type="number" class="form-control" id="finalGrade" min="1.0" max="7.0" step="0.1" value="4.0">
                                    <div class="form-text">Ingrese la calificación final del estudiante en escala de 1.0 a 7.0</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Retroalimentación y empleabilidad -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-comments me-2"></i>Retroalimentación y Empleabilidad</h5>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Posibilidad de contratación</label>
                                    <div class="option-selector">
                                        <div class="options-container">
                                            <div class="option-item eval-excellent">
                                                <input type="radio" name="hiringPotential" id="hiringHigh" value="alta">
                                                <label for="hiringHigh">Alta</label>
                                            </div>
                                            <div class="option-item eval-good">
                                                <input type="radio" name="hiringPotential" id="hiringMedium" value="media">
                                                <label for="hiringMedium">Media</label>
                                            </div>
                                            <div class="option-item eval-deficient">
                                                <input type="radio" name="hiringPotential" id="hiringLow" value="baja">
                                                <label for="hiringLow">Baja</label>
                                            </div>
                                            <div class="option-item eval-bad">
                                                <input type="radio" name="hiringPotential" id="hiringNone" value="ninguna">
                                                <label for="hiringNone">Ninguna</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="hiringPotentialValue">
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Estado contratación post-práctica</label>
                                    <select class="form-select" id="postPracticeStatus">
                                        <option value="pendiente">Pendiente</option>
                                        <option value="contratado">Contratado</option>
                                        <option value="no-contratado">No contratado</option>
                                        <option value="contrato-pendiente">Contrato en evaluación</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label for="studentFeedback" class="form-label">Retroalimentación del estudiante</label>
                                    <textarea class="form-control" id="studentFeedback" rows="3" placeholder="Comentarios del estudiante sobre su experiencia en el centro de práctica"></textarea>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label for="instructorComments" class="form-label">Comentarios del instructor</label>
                                    <textarea class="form-control" id="instructorComments" rows="3" placeholder="Comentarios del instructor sobre el desempeño del estudiante"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Documentación -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-file-alt me-2"></i>Documentación</h5>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Documentación instructor</label>
                                    <div class="input-group">
                                        <input type="file" class="form-control" id="instructorDoc">
                                        <button class="btn btn-outline-secondary" type="button" id="viewInstructorDoc" disabled>
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Documentación finalización</label>
                                    <div class="input-group">
                                        <input type="file" class="form-control" id="completionDoc">
                                        <button class="btn btn-outline-secondary" type="button" id="viewCompletionDoc" disabled>
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-end mt-4">
                            <button type="button" class="btn btn-danger me-2" id="deleteStudentBtn">
                                <i class="fas fa-trash-alt me-1"></i> Eliminar Estudiante
                            </button>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para agregar/editar centro de práctica -->
    <div class="modal fade" id="centerModal" tabindex="-1" aria-labelledby="centerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="centerModalLabel">Centro de Práctica</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="centerForm">
                        <input type="hidden" id="centerId">
                        
                        <!-- Información básica -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-building me-2"></i>Información Básica</h5>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="centerName" class="form-label">Nombre del centro</label>
                                    <input type="text" class="form-control" id="centerName" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="centerIndustry" class="form-label">Sector industrial</label>
                                    <select class="form-select" id="centerIndustry" required>
                                        <option value="" selected disabled>Seleccionar sector</option>
                                        <option value="mineria">Minería</option>
                                        <option value="industria">Industria manufacturera</option>
                                        <option value="tecnologia">Tecnología</option>
                                        <option value="servicios">Servicios</option>
                                        <option value="comercio">Comercio</option>
                                        <option value="construccion">Construcción</option>
                                        <option value="agricultura">Agricultura</option>
                                        <option value="educacion">Educación</option>
                                        <option value="salud">Salud</option>
                                        <option value="publico">Sector público</option>
                                        <option value="otro">Otro</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label for="centerDescription" class="form-label">Descripción</label>
                                    <textarea class="form-control" id="centerDescription" rows="3" placeholder="Breve descripción del centro de práctica"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ubicación y contacto -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-map-marker-alt me-2"></i>Ubicación y Contacto</h5>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="centerRegion" class="form-label">Región</label>
                                    <select class="form-select" id="centerRegion" required>
                                        <option value="" selected disabled>Seleccionar región</option>
                                        <option value="arica">Arica y Parinacota</option>
                                        <option value="tarapaca">Tarapacá</option>
                                        <option value="antofagasta">Antofagasta</option>
                                        <option value="atacama">Atacama</option>
                                        <option value="coquimbo">Coquimbo</option>
                                        <option value="valparaiso">Valparaíso</option>
                                        <option value="metropolitana">Metropolitana</option>
                                        <option value="ohiggins">O'Higgins</option>
                                        <option value="maule">Maule</option>
                                        <option value="nuble">Ñuble</option>
                                        <option value="biobio">Biobío</option>
                                        <option value="araucania">La Araucanía</option>
                                        <option value="losrios">Los Ríos</option>
                                        <option value="loslagos">Los Lagos</option>
                                        <option value="aysen">Aysén</option>
                                        <option value="magallanes">Magallanes</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="centerCity" class="form-label">Ciudad</label>
                                    <input type="text" class="form-control" id="centerCity" required>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label for="centerAddress" class="form-label">Dirección</label>
                                    <div class="input-group mb-2">
                                        <input type="text" class="form-control" id="centerAddress" placeholder="Dirección completa" required>
                                        <button class="btn btn-outline-secondary" type="button" id="searchLocationBtn">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <div class="mini-map-container" id="centerLocationMap"></div>
                                    <input type="hidden" id="centerLatitude">
                                    <input type="hidden" id="centerLongitude">
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="centerContactName" class="form-label">Nombre de contacto</label>
                                    <input type="text" class="form-control" id="centerContactName">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="centerContactEmail" class="form-label">Email de contacto</label>
                                    <input type="email" class="form-control" id="centerContactEmail">
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="centerContactPhone" class="form-label">Teléfono de contacto</label>
                                    <input type="tel" class="form-control" id="centerContactPhone">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="centerWebsite" class="form-label">Sitio web</label>
                                    <input type="url" class="form-control" id="centerWebsite" placeholder="https://...">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Evaluación de pertinencia -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-check-circle me-2"></i>Evaluación de Pertinencia</h5>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Alineación con perfil de egreso</label>
                                    <div class="option-selector">
                                        <div class="options-container">
                                            <div class="option-item eval-excellent">
                                                <input type="radio" name="alignmentEvaluation" id="alignmentExcellent" value="excelente">
                                                <label for="alignmentExcellent">Excelente</label>
                                            </div>
                                            <div class="option-item eval-good">
                                                <input type="radio" name="alignmentEvaluation" id="alignmentGood" value="buena">
                                                <label for="alignmentGood">Buena</label>
                                            </div>
                                            <div class="option-item eval-sufficient">
                                                <input type="radio" name="alignmentEvaluation" id="alignmentSufficient" value="suficiente">
                                                <label for="alignmentSufficient">Suficiente</label>
                                            </div>
                                            <div class="option-item eval-deficient">
                                                <input type="radio" name="alignmentEvaluation" id="alignmentDeficient" value="deficiente">
                                                <label for="alignmentDeficient">Deficiente</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="alignmentEvaluationValue">
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Relevancia en la industria</label>
                                    <div class="option-selector">
                                        <div class="options-container">
                                            <div class="option-item eval-excellent">
                                                <input type="radio" name="relevanceEvaluation" id="relevanceHigh" value="alta">
                                                <label for="relevanceHigh">Alta</label>
                                            </div>
                                            <div class="option-item eval-good">
                                                <input type="radio" name="relevanceEvaluation" id="relevanceMedium" value="media">
                                                <label for="relevanceMedium">Media</label>
                                            </div>
                                            <div class="option-item eval-deficient">
                                                <input type="radio" name="relevanceEvaluation" id="relevanceLow" value="baja">
                                                <label for="relevanceLow">Baja</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="relevanceEvaluationValue">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Calidad de supervisión</label>
                                    <div class="option-selector">
                                        <div class="options-container">
                                            <div class="option-item eval-excellent">
                                                <input type="radio" name="supervisionQuality" id="supervisionExcellent" value="excelente">
                                                <label for="supervisionExcellent">Excelente</label>
                                            </div>
                                            <div class="option-item eval-good">
                                                <input type="radio" name="supervisionQuality" id="supervisionGood" value="buena">
                                                <label for="supervisionGood">Buena</label>
                                            </div>
                                            <div class="option-item eval-sufficient">
                                                <input type="radio" name="supervisionQuality" id="supervisionSufficient" value="suficiente">
                                                <label for="supervisionSufficient">Suficiente</label>
                                            </div>
                                            <div class="option-item eval-deficient">
                                                <input type="radio" name="supervisionQuality" id="supervisionDeficient" value="deficiente">
                                                <label for="supervisionDeficient">Deficiente</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="supervisionQualityValue">
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Infraestructura y recursos</label>
                                    <div class="option-selector">
                                        <div class="options-container">
                                            <div class="option-item eval-excellent">
                                                <input type="radio" name="infrastructureQuality" id="infrastructureExcellent" value="excelente">
                                                <label for="infrastructureExcellent">Excelente</label>
                                            </div>
                                            <div class="option-item eval-good">
                                                <input type="radio" name="infrastructureQuality" id="infrastructureGood" value="buena">
                                                <label for="infrastructureGood">Buena</label>
                                            </div>
                                            <div class="option-item eval-sufficient">
                                                <input type="radio" name="infrastructureQuality" id="infrastructureSufficient" value="suficiente">
                                                <label for="infrastructureSufficient">Suficiente</label>
                                            </div>
                                            <div class="option-item eval-deficient">
                                                <input type="radio" name="infrastructureQuality" id="infrastructureDeficient" value="deficiente">
                                                <label for="infrastructureDeficient">Deficiente</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="infrastructureQualityValue">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label for="relevantCareers" class="form-label">Carreras pertinentes</label>
                                    <select class="form-select" id="relevantCareers" multiple>
                                        <!-- Opciones se cargarán dinámicamente -->
                                    </select>
                                    <div class="form-text">Seleccione las carreras para las que este centro es relevante</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Aporte y retribución -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-handshake me-2"></i>Aporte y Retribución</h5>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="studentBenefits" class="form-label">Beneficios para estudiantes</label>
                                    <select class="form-select" id="studentBenefits" multiple>
                                        <option value="remuneracion">Remuneración económica</option>
                                        <option value="alimentacion">Alimentación</option>
                                        <option value="transporte">Transporte</option>
                                        <option value="capacitacion">Capacitación adicional</option>
                                        <option value="empleo">Posibilidad de empleo posterior</option>
                                        <option value="flexibilidad">Flexibilidad horaria</option>
                                        <option value="otros">Otros beneficios</option>
                                    </select>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label for="uacBenefits" class="form-label">Aporte a la UAC</label>
                                    <select class="form-select" id="uacBenefits" multiple>
                                        <option value="equipamiento">Donación de equipamiento</option>
                                        <option value="charlas">Charlas/workshops</option>
                                        <option value="investigacion">Proyectos de investigación</option>
                                        <option value="financiamiento">Financiamiento académico</option>
                                        <option value="capacitacion">Capacitación a docentes</option>
                                        <option value="otros">Otros aportes</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label for="feedbackMechanisms" class="form-label">Mecanismos de retribución establecidos</label>
                                    <textarea class="form-control" id="feedbackMechanisms" rows="3" placeholder="Describa los mecanismos de retribución y feedback establecidos con este centro"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Potencial estratégico -->
                        <div class="form-section">
                            <h5 class="form-section-title"><i class="fas fa-chess me-2"></i>Potencial Estratégico</h5>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Nivel de impacto estratégico</label>
                                    <div class="option-selector">
                                        <div class="options-container">
                                            <div class="option-item eval-excellent">
                                                <input type="radio" name="strategicImpact" id="impactHigh" value="alto">
                                                <label for="impactHigh">Alto</label>
                                            </div>
                                            <div class="option-item eval-good">
                                                <input type="radio" name="strategicImpact" id="impactMedium" value="medio">
                                                <label for="impactMedium">Medio</label>
                                            </div>
                                            <div class="option-item eval-deficient">
                                                <input type="radio" name="strategicImpact" id="impactLow" value="bajo">
                                                <label for="impactLow">Bajo</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="strategicImpactValue">
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Potencial de colaboración futura</label>
                                    <div class="option-selector">
                                        <div class="options-container">
                                            <div class="option-item eval-excellent">
                                                <input type="radio" name="futurePotential" id="potentialHigh" value="alto">
                                                <label for="potentialHigh">Alto</label>
                                            </div>
                                            <div class="option-item eval-good">
                                                <input type="radio" name="futurePotential" id="potentialMedium" value="medio">
                                                <label for="potentialMedium">Medio</label>
                                            </div>
                                            <div class="option-item eval-deficient">
                                                <input type="radio" name="futurePotential" id="potentialLow" value="bajo">
                                                <label for="potentialLow">Bajo</label>
                                            </div>
                                        </div>
                                        <input type="hidden" id="futurePotentialValue">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label for="allianceAreas" class="form-label">Áreas potenciales para alianzas estratégicas</label>
                                    <select class="form-select" id="allianceAreas" multiple>
                                        <option value="practicas">Prácticas profesionales</option>
                                        <option value="investigacion">Investigación conjunta</option>
                                        <option value="capacitacion">Capacitación especializada</option>
                                        <option value="proyectos">Proyectos colaborativos</option>
                                        <option value="infraestructura">Uso compartido de infraestructura</option>
                                        <option value="consultoria">Consultoría</option>
                                        <option value="empleabilidad">Empleabilidad de egresados</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label for="strategicObservations" class="form-label">Observaciones estratégicas</label>
                                    <textarea class="form-control" id="strategicObservations" rows="3" placeholder="Observaciones sobre el potencial estratégico de este centro"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-end mt-4">
                            <button type="button" class="btn btn-danger me-2" id="deleteCenterBtn">
                                <i class="fas fa-trash-alt me-1"></i> Eliminar Centro
                            </button>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Guardar Centro</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para retroalimentación -->
    <div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="feedbackModalLabel">Nueva Retroalimentación</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="feedbackForm">
                        <input type="hidden" id="feedbackId">
                        <input type="hidden" id="feedbackType">
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="feedbackCenter" class="form-label">Centro de Práctica</label>
                                <select class="form-select" id="feedbackCenter" required>
                                    <option value="" selected disabled>Seleccionar centro</option>
                                    <!-- Opciones se cargarán dinámicamente -->
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="feedbackDate" class="form-label">Fecha</label>
                                <input type="text" class="form-control datepicker" id="feedbackDate" required>
                            </div>
                        </div>
                        
                        <div class="row mb-3" id="studentFeedbackSection" style="display: none;">
                            <div class="col-md-12">
                                <label for="feedbackStudent" class="form-label">Estudiante</label>
                                <select class="form-select" id="feedbackStudent">
                                    <option value="" selected disabled>Seleccionar estudiante</option>
                                    <!-- Opciones se cargarán dinámicamente -->
                                </select>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="feedbackCategory" class="form-label">Categoría</label>
                                <select class="form-select" id="feedbackCategory" required>
                                    <option value="" selected disabled>Seleccionar categoría</option>
                                    <option value="infraestructura">Infraestructura</option>
                                    <option value="supervision">Supervisión y Tutoría</option>
                                    <option value="aprendizaje">Oportunidades de Aprendizaje</option>
                                    <option value="ambiente">Ambiente Laboral</option>
                                    <option value="pertinencia">Pertinencia Académica</option>
                                    <option value="comunicacion">Comunicación</option>
                                    <option value="general">Evaluación General</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Valoración</label>
                                <div class="option-selector">
                                    <div class="options-container">
                                        <div class="option-item eval-excellent">
                                            <input type="radio" name="feedbackRating" id="ratingExcellent" value="excelente">
                                            <label for="ratingExcellent">Excelente</label>
                                        </div>
                                        <div class="option-item eval-good">
                                            <input type="radio" name="feedbackRating" id="ratingGood" value="bueno">
                                            <label for="ratingGood">Bueno</label>
                                        </div>
                                        <div class="option-item eval-sufficient">
                                            <input type="radio" name="feedbackRating" id="ratingSufficient" value="suficiente">
                                            <label for="ratingSufficient">Suficiente</label>
                                        </div>
                                        <div class="option-item eval-deficient">
                                            <input type="radio" name="feedbackRating" id="ratingDeficient" value="deficiente">
                                            <label for="ratingDeficient">Deficiente</label>
                                        </div>
                                        <div class="option-item eval-bad">
                                            <input type="radio" name="feedbackRating" id="ratingBad" value="malo">
                                            <label for="ratingBad">Malo</label>
                                        </div>
                                    </div>
                                    <input type="hidden" id="feedbackRatingValue" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="feedbackComments" class="form-label">Comentarios</label>
                                <textarea class="form-control" id="feedbackComments" rows="5" required placeholder="Detalle su retroalimentación, comentarios o sugerencias..."></textarea>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="feedbackSuggestions" class="form-label">Sugerencias de mejora</label>
                                <textarea class="form-control" id="feedbackSuggestions" rows="3" placeholder="Sugerencias específicas para mejorar..."></textarea>
                            </div>
                        </div>
                        
                        <div class="row mb-3" id="uacFeedbackSection">
                            <div class="col-md-12">
                                <label for="feedbackFollowUp" class="form-label">Plan de seguimiento</label>
                                <textarea class="form-control" id="feedbackFollowUp" rows="3" placeholder="Acciones propuestas para seguimiento..."></textarea>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="feedbackAttachment" class="form-label">Adjuntar archivo</label>
                                <input type="file" class="form-control" id="feedbackAttachment">
                            </div>
                        </div>
                        
                        <div class="text-end mt-4">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Guardar Retroalimentación</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para solicitar retroalimentación -->
    <div class="modal fade" id="requestFeedbackModal" tabindex="-1" aria-labelledby="requestFeedbackModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="requestFeedbackModalLabel">Solicitar Retroalimentación</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="requestFeedbackForm">
                        <input type="hidden" id="requestType">
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="requestCenter" class="form-label">Centro de Práctica</label>
                                <select class="form-select" id="requestCenter" required>
                                    <option value="" selected disabled>Seleccionar centro</option>
                                    <!-- Opciones se cargarán dinámicamente -->
                                </select>
                            </div>
                            <div class="col-md-6" id="requestStudentSection" style="display: none;">
                                <label for="requestStudent" class="form-label">Estudiante</label>
                                <select class="form-select" id="requestStudent">
                                    <option value="" selected disabled>Seleccionar estudiante</option>
                                    <!-- Opciones se cargarán dinámicamente -->
                                </select>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="requestContactName" class="form-label">Nombre de contacto</label>
                                <input type="text" class="form-control" id="requestContactName" required>
                            </div>
                            <div class="col-md-6">
                                <label for="requestContactEmail" class="form-label">Email de contacto</label>
                                <input type="email" class="form-control" id="requestContactEmail" required>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="requestSubject" class="form-label">Asunto</label>
                                <input type="text" class="form-control" id="requestSubject" required>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label for="requestMessage" class="form-label">Mensaje</label>
                                <textarea class="form-control" id="requestMessage" rows="5" required></textarea>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="requestIncludeForm">
                                    <label class="form-check-label" for="requestIncludeForm">
                                        Incluir formulario de evaluación estandarizado
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-end mt-4">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Enviar Solicitud</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para documentos -->
    <div class="modal fade" id="documentModal" tabindex="-1" aria-labelledby="documentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="documentModalLabel">Documentación</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div id="documentViewer" class="text-center">
                        <!-- El contenido se generará dinámicamente -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <a id="downloadDocumentBtn" href="#" class="btn btn-primary">
                        <i class="fas fa-download me-1"></i> Descargar
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de confirmación para eliminar estudiante -->
    <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="deleteConfirmModalLabel">Confirmar eliminación</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <p><i class="fas fa-exclamation-triangle text-danger me-2"></i> ¿Está seguro que desea eliminar este registro?</p>
                    <p class="fw-bold" id="elementToDeleteName"></p>
                    <p>Esta acción no se puede deshacer.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
                        <i class="fas fa-trash-alt me-1"></i> Eliminar definitivamente
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de detalles de centro de práctica -->
    <div class="modal fade" id="centerDetailsModal" tabindex="-1" aria-labelledby="centerDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="centerDetailsModalLabel">Detalles del Centro de Práctica</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div id="centerDetailsContent">
                        <!-- Contenido se cargará dinámicamente -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" id="editCenterBtn">
                        <i class="fas fa-edit me-1"></i> Editar Centro
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-0">© 2025 Universidad de Aconcagua</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="mb-0">Coordinación de Centros de Prácticas e Inserción Laboral</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Libraries -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/es.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
// Datos de carreras y sedes
const carreras = [
    'Técnico De Nivel Superior En Administración De Empresas',
    'Técnico De Nivel Superior En Agronomía',
    'Técnico De Nivel Superior En Automatización Y Control Industrial',
    'Técnico De Nivel Superior En Construcción',
    'Técnico De Nivel Superior En Electricidad',
    'Técnico De Nivel Superior En Mantenimiento Industrial',
    'Técnico De Nivel Superior En Mecánica Industrial',
    'Técnico De Nivel Superior En Minas',
    'Técnico De Nivel Superior En Minería Y Metalurgia',
    'Técnico Nivel Superior En Construcción Y Obras Civiles',
    'Ing. Industrial',
    'Ing. En Administración De Empresas',
    'Ing. En Administracion De Empresas (PCE)',
    'Ing. En Administracion Publica (PCE)',
    'Ing. Comercial (PCE) Para TNS',
    'Ing. En Construccion M/ Gestion De Obras (PCE) Para TNS',
    'Ing. Civil Industrial M/ Gestion De Operaciones (PCE) Otra Area',
    'Ing. En Construccion M/ Gestion De Obras (PCE) Para Cc',
    'Ing. En Minas M/ Seguridad Minera (PCE) Del Area',
    'Ing. Civil En Minas M/ Seguridad Minera (PCE) Otra Area',
    'Ing. En Construccion M/ Gestion De Obras (PCE) Otra Area',
    'Ing. Comercial (PCE) Para Prof.',
    'Ing. Industrial M/ Gestion De Operaciones (PCE)',
    'Ing. En Prevencion De Riesgos M/ Sistemas De Gestion (PCE) Del Area',
    'Ing. Industrial M/ Gestion De Operaciones (PCE) Del Area',
    'Ing. Civil En Minas M/ Seguridad Minera (PCE) Del Area',
    'Ing. Civil Industrial M/ Gestion De Operaciones (PCE) Del Area',
    'Ing. En Minas M/ Seguridad Minera (PCE) Otra Area'
];

const sedes = ['Ancud', 'Calama', 'Los Andes', 'San Felipe', 'Machali', 'Campus Virtual'];

// Datos para el sistema
let studentsData = [];
let centersData = [];
let feedbackData = [];
let currentPage = 1;
const studentsPerPage = 5;
const centersPerPage = 5;
const feedbackPerPage = 5;
let totalPages = 0;
let activeFilters = {
    search: '',
    career: '',
    status: ''
};

// Variable para almacenar el ID del elemento a eliminar
let elementIdToDelete = null;
let deleteType = null;

// Variables para gráficos
let statusChart, campusChart, careerChart, evaluationChart, gradesChart;
let sectorDistributionChart, relevanceDistributionChart, geographicDistributionChart, temporalEvolutionChart;

// Variables para mapa
let centersMap, centerLocationMap;
let markerClusterGroup;

// Función para obtener el encargado de práctica según carrera y sede
function obtenerEncargadoPractica(carrera, sede) {
    if (carrera === 'Técnico De Nivel Superior En Agronomía' && sede === 'San Felipe') {
        return 'Director/a de Carrera';
    } else if (carrera !== 'Técnico De Nivel Superior En Agronomía' && sede === 'Los Andes') {
        return 'Director/a de Carrera';
    } else if (carrera !== 'Técnico De Nivel Superior En Agronomía' && sede === 'Calama') {
        return 'Director/a de Carrera';
    } else if (['Machali', 'Ancud'].includes(sede)) {
        return 'Director/a Académico/a';
    } else {
        return 'Tutor/a Virtual';
    }
}

// Función para cargar los datos de estudiantes
function loadStudentsData() {
    const savedData = JSON.parse(localStorage.getItem('datosPracticas')) || [];
    studentsData = savedData.map((student, index) => {
        return {
            id: index,
            nombre: student.nombre || '',
            rut: student.rut || '',
            carrera: student.carrera || carreras[0],
            sede: student.sede || sedes[0],
            encargadoPractica: student.encargadoPractica || obtenerEncargadoPractica(student.carrera, student.sede),
            centroPractica: student.centroPractica || '',
            instructor: student.instructor || '',
            instrumentoMetodologico: student.instrumentoMetodologico || 'Informe de Practica',
            fechaInicio: student.fechaInicio || '',
            fechaTermino: student.fechaTermino || '',
            seguimiento1: student.seguimiento1 || 'no-comienza',
            evaluacionParcial: student.evaluacionParcial || 'excelente',
            seguimiento2: student.seguimiento2 || 'no-comienza',
            revisionAvance: student.revisionAvance || 'excelente',
            evaluacionInstructor: student.evaluacionInstructor || 'excelente',
            documentoInstructor: false, // Este campo requeriría almacenamiento de archivos real
            finalizacionPractica: student.finalizacionPractica || 'no-comienza',
            documentoFinalizacion: false, // Este campo requeriría almacenamiento de archivos real
            asignacionHoraExamen: student.asignacionHoraExamen || 'no-comienza',
            notaFinal: student.notaFinal || 4.0,
            lineaInvestigacion: student.lineaInvestigacion || '',
            hiringPotential: student.hiringPotential || 'baja',
            postPracticeStatus: student.postPracticeStatus || 'pendiente',
            studentFeedback: student.studentFeedback || '',
            instructorComments: student.instructorComments || ''
        };
    }).filter(student => student.nombre.trim() !== ''); // Filtrar estudiantes sin nombre
    
    updateStatistics();
    renderStudentsList();
    setupFilterCareerOptions();
}

// Función para cargar datos de centros de práctica
function loadCentersData() {
    const savedCenters = JSON.parse(localStorage.getItem('datosCentrosPracticas')) || [];
    
    if (savedCenters.length === 0) {
        // Datos de ejemplo si no hay datos guardados
        centersData = [
            {
                id: 1,
                nombre: 'Minera Los Andes',
                sector: 'mineria',
                descripcion: 'Empresa líder en extracción de cobre en la región de Valparaíso',
                region: 'valparaiso',
                ciudad: 'Los Andes',
                direccion: 'Av. Minera 123, Los Andes',
                latitud: -32.8319,
                longitud: -70.6008,
                contactoNombre: 'Juan Pérez',
                contactoEmail: 'jperez@minera.cl',
                contactoTelefono: '+56912345678',
                sitioWeb: 'https://www.mineraejemplo.cl',
                alineacionPerfil: 'excelente',
                relevanciaIndustria: 'alta',
                calidadSupervision: 'buena',
                infraestructura: 'excelente',
                carrerasPertinentes: ['Técnico De Nivel Superior En Minas', 'Ing. En Minas M/ Seguridad Minera (PCE) Del Area'],
                beneficiosEstudiante: ['remuneracion', 'alimentacion', 'transporte'],
                beneficiosUAC: ['charlas', 'investigacion'],
                mecanismosRetribucion: 'Participación en ferias laborales, charlas técnicas para estudiantes',
                impactoEstrategico: 'alto',
                potencialColaboracion: 'alto',
                areasAlianza: ['practicas', 'investigacion', 'empleabilidad'],
                observacionesEstrategicas: 'Excelente relación institucional, potencial para proyectos de investigación',
                evaluacionGeneral: 'excelente'
            },
            {
                id: 2,
                nombre: 'TechSolutions SA',
                sector: 'tecnologia',
                descripcion: 'Empresa de desarrollo de software y soluciones tecnológicas',
                region: 'metropolitana',
                ciudad: 'Santiago',
                direccion: 'Apoquindo 4800, Las Condes, Santiago',
                latitud: -33.4190,
                longitud: -70.5841,
                contactoNombre: 'María González',
                contactoEmail: 'mgonzalez@techsolutions.cl',
                contactoTelefono: '+56987654321',
                sitioWeb: 'https://www.techsolutions.cl',
                alineacionPerfil: 'buena',
                relevanciaIndustria: 'alta',
                calidadSupervision: 'excelente',
                infraestructura: 'excelente',
                carrerasPertinentes: ['Ing. Industrial', 'Ing. Civil Industrial M/ Gestion De Operaciones (PCE) Del Area'],
                beneficiosEstudiante: ['remuneracion', 'capacitacion', 'empleo'],
                beneficiosUAC: ['equipamiento', 'capacitacion'],
                mecanismosRetribucion: 'Donación de equipos informáticos, capacitación a docentes en nuevas tecnologías',
                impactoEstrategico: 'medio',
                potencialColaboracion: 'alto',
                areasAlianza: ['practicas', 'capacitacion', 'proyectos'],
                observacionesEstrategicas: 'Potencial para desarrollar proyectos de transformación digital',
                evaluacionGeneral: 'buena'
            },
            {
                id: 3,
                nombre: 'Constructora Valle Central',
                sector: 'construccion',
                descripcion: 'Empresa dedicada a la construcción de obras civiles y edificación',
                region: 'ohiggins',
                ciudad: 'Rancagua',
                direccion: 'Av. Bernardo O\'Higgins 123, Rancagua',
                latitud: -34.1701,
                longitud: -70.7404,
                contactoNombre: 'Roberto Silva',
                contactoEmail: 'rsilva@constructoravc.cl',
                contactoTelefono: '+56945678901',
                sitioWeb: 'https://www.constructoravallecentral.cl',
                alineacionPerfil: 'excelente',
                relevanciaIndustria: 'media',
                calidadSupervision: 'buena',
                infraestructura: 'buena',
                carrerasPertinentes: ['Técnico De Nivel Superior En Construcción', 'Ing. En Construccion M/ Gestion De Obras (PCE) Para TNS'],
                beneficiosEstudiante: ['alimentacion', 'transporte'],
                beneficiosUAC: ['charlas'],
                mecanismosRetribucion: 'Visitas a obras en construcción, charlas técnicas',
                impactoEstrategico: 'medio',
                potencialColaboracion: 'medio',
                areasAlianza: ['practicas', 'proyectos'],
                observacionesEstrategicas: 'Buena disposición para recibir estudiantes, pero limitado en recursos para investigación',
                evaluacionGeneral: 'buena'
            }
        ];
        
        // Guardar los datos de ejemplo en localStorage
        saveToLocalStorage('centers');
    } else {
        centersData = savedCenters;
    }
    
    updateCentersStatistics();
    renderCentersList();
    initializeMaps();
    loadCentersIntoSelects();
}

// Función para cargar datos de retroalimentación
function loadFeedbackData() {
    const savedFeedback = JSON.parse(localStorage.getItem('datosRetroalimentacion')) || [];
    
    if (savedFeedback.length === 0) {
        // Datos de ejemplo si no hay datos guardados
        feedbackData = [
            {
                id: 1,
                tipo: 'uac', // UAC a Centro
                centroId: 1,
                centroNombre: 'Minera Los Andes',
                fecha: '15/06/2025',
                categoria: 'supervision',
                valoracion: 'excelente',
                comentarios: 'Excelente disposición para integrar a los estudiantes en proyectos reales. El encargado de prácticas mantiene comunicación constante con la universidad.',
                sugerencias: 'Considerar la posibilidad de ampliar cupos para prácticas en el área de mantenimiento.',
                seguimiento: 'Reunión programada para el próximo semestre para discutir ampliación de convenio.',
                archivoAdjunto: false
            },
            {
                id: 2,
                tipo: 'centro', // Centro a UAC
                centroId: 2,
                centroNombre: 'TechSolutions SA',
                fecha: '20/05/2025',
                categoria: 'aprendizaje',
                valoracion: 'bueno',
                comentarios: 'Los estudiantes de la UAC muestran buena preparación teórica, pero requieren mayor experiencia práctica en herramientas específicas de la industria.',
                sugerencias: 'Recomendamos incluir más ejercicios prácticos con herramientas como Docker y Kubernetes en la formación.',
                seguimiento: '',
                archivoAdjunto: false
            },
            {
                id: 3,
                tipo: 'estudiante', // Estudiante
                centroId: 3,
                centroNombre: 'Constructora Valle Central',
                estudianteId: 0,
                estudianteNombre: 'Juan Ejemplo',
                fecha: '05/07/2025',
                categoria: 'ambiente',
                valoracion: 'excelente',
                comentarios: 'Excelente ambiente laboral, equipo muy colaborativo que facilitó mi integración. Aprendí herramientas prácticas no vistas en clases.',
                sugerencias: 'Sería útil tener una inducción más detallada al inicio de la práctica sobre los procesos de la empresa.',
                seguimiento: '',
                archivoAdjunto: false
            }
        ];
        
        // Guardar los datos de ejemplo en localStorage
        saveToLocalStorage('feedback');
    } else {
        feedbackData = savedFeedback;
    }
    
    renderUACFeedbackList();
    renderCenterFeedbackList();
    renderStudentFeedbackList();
}

// Función para filtrar estudiantes según los criterios activos
function filterStudents() {
    return studentsData.filter(student => {
        // Filtro por búsqueda
        const searchMatch = !activeFilters.search || 
            student.nombre.toLowerCase().includes(activeFilters.search.toLowerCase()) ||
            student.rut.toLowerCase().includes(activeFilters.search.toLowerCase()) ||
            student.centroPractica.toLowerCase().includes(activeFilters.search.toLowerCase());
        
        // Filtro por carrera
        const careerMatch = !activeFilters.career || student.carrera === activeFilters.career;
        
        // Filtro por estado
        const statusMatch = !activeFilters.status || student.finalizacionPractica === activeFilters.status;
        
        return searchMatch && careerMatch && statusMatch;
    });
}

// Función para renderizar la lista de estudiantes con paginación
function renderStudentsList() {
    const filteredStudents = filterStudents();
    totalPages = Math.ceil(filteredStudents.length / studentsPerPage);
    
    // Asegurar que la página actual es válida
    if (currentPage > totalPages) {
        currentPage = totalPages > 0 ? totalPages : 1;
    }
    
    const startIndex = (currentPage - 1) * studentsPerPage;
    const endIndex = startIndex + studentsPerPage;
    const currentStudents = filteredStudents.slice(startIndex, endIndex);
    
    const studentsList = document.getElementById('studentsList');
    studentsList.innerHTML = '';
    
    if (currentStudents.length === 0) {
        studentsList.innerHTML = `
            <div class="text-center py-5">
                <i class="fas fa-search fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No se encontraron estudiantes</h4>
                <p>Intenta con otros criterios de búsqueda o agrega nuevos estudiantes.</p>
            </div>
        `;
        return;
    }
    
    currentStudents.forEach(student => {
        // Calcular progreso
        const stagesCompleted = [
            student.seguimiento1 === 'completada',
            student.evaluacionParcial !== '',
            student.seguimiento2 === 'completada',
            student.revisionAvance !== '',
            student.evaluacionInstructor !== '',
            student.documentoInstructor,
            student.finalizacionPractica === 'completada',
            student.documentoFinalizacion,
            student.asignacionHoraExamen === 'completada'
        ].filter(Boolean).length;
        
        const progress = Math.round((stagesCompleted / 9) * 100);
        
        // Determinar estado global para color de progreso
        let statusClass = 'bg-danger';
        if (student.finalizacionPractica === 'completada') {
            statusClass = 'bg-success';
        } else if (student.finalizacionPractica === 'en-proceso') {
            statusClass = 'bg-warning';
        }
        
        // Crear etiqueta de estado
        let statusBadge = '';
        if (student.finalizacionPractica === 'no-comienza') {
            statusBadge = `<span class="stage-badge stage-not-started">Pendiente</span>`;
        } else if (student.finalizacionPractica === 'en-proceso') {
            statusBadge = `<span class="stage-badge stage-in-progress">En proceso</span>`;
        } else {
            statusBadge = `<span class="stage-badge stage-completed">Completada</span>`;
        }
        
        // Crear iniciales para foto
        const initials = student.nombre
            .split(' ')
            .map(name => name.charAt(0))
            .join('')
            .substring(0, 2)
            .toUpperCase();
        
        // Determinar clase para la nota final
        let gradeClass = '';
        if (student.notaFinal >= 6.0) {
            gradeClass = 'high';
        } else if (student.notaFinal >= 4.0) {
            gradeClass = 'medium';
        } else {
            gradeClass = 'low';
        }
        
        // Estado de contratación
        let hiringStatus = '';
        if (student.postPracticeStatus === 'contratado') {
            hiringStatus = `<span class="badge bg-success ms-2">Contratado</span>`;
        } else if (student.postPracticeStatus === 'contrato-pendiente') {
            hiringStatus = `<span class="badge bg-warning text-dark ms-2">Contrato en evaluación</span>`;
        }
        
        // Renderizar tarjeta
        const card = document.createElement('div');
        card.className = 'student-card';
        card.innerHTML = `
            <div class="card-header">
                <span>Estudiante #${student.id + 1}</span>
                ${statusBadge}
            </div>
            <div class="card-body">
                <div class="student-info">
                    <div class="student-photo">
                        ${initials}
                    </div>
                    <div class="student-details">
                        <div class="student-name">${student.nombre}</div>
                        <div class="student-id">RUT: ${student.rut}</div>
                        <div class="student-career"><strong>Carrera:</strong> ${student.carrera}</div>
                        <div class="student-campus"><strong>Sede:</strong> ${student.sede}</div>
                        <div class="mt-2">
                            <strong>Centro de práctica:</strong> ${student.centroPractica || 'No asignado'}
                        </div>
                        <div class="final-grade ${gradeClass}">
                            <i class="fas fa-graduation-cap me-1"></i> Nota Final: ${student.notaFinal}
                            ${hiringStatus}
                        </div>
                    </div>
                </div>
                
                <div class="progress-section">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span class="progress-title">Progreso de la práctica</span>
                        <span>${progress}%</span>
                    </div>
                    <div class="progress mb-3">
                        <div class="progress-bar ${statusClass}" role="progressbar" style="width: ${progress}%" 
                            aria-valuenow="${progress}" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-4 mb-2">
                            <small>Seguimiento 1: <span class="status-${student.seguimiento1}">
                                ${student.seguimiento1 === 'no-comienza' ? 'Pendiente' : 
                                  student.seguimiento1 === 'en-proceso' ? 'En proceso' : 'Completado'}
                            </span></small>
                        </div>
                        <div class="col-md-4 mb-2">
                            <small>Seguimiento 2: <span class="status-${student.seguimiento2}">
                                ${student.seguimiento2 === 'no-comienza' ? 'Pendiente' : 
                                  student.seguimiento2 === 'en-proceso' ? 'En proceso' : 'Completado'}
                            </span></small>
                        </div>
                        <div class="col-md-4 mb-2">
                            <small>Evaluación: <strong>${student.evaluacionInstructor.charAt(0).toUpperCase() + student.evaluacionInstructor.slice(1)}</strong></small>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-edit edit-student" data-id="${student.id}">
                        <i class="fas fa-edit"></i> Editar información
                    </button>
                    <button class="btn btn-document upload-document" data-id="${student.id}" data-type="instructor">
                        <i class="fas fa-file-upload"></i> Documentación instructor
                    </button>
                    <button class="btn btn-document upload-document" data-id="${student.id}" data-type="completion">
                        <i class="fas fa-file-upload"></i> Documentación finalización
                    </button>
                </div>
            </div>
        `;
        
        studentsList.appendChild(card);
    });
    
    renderPagination();
}

// Función para renderizar la lista de centros de práctica
function renderCentersList() {
    const centersList = document.getElementById('centersList');
    centersList.innerHTML = '';
    
    if (centersData.length === 0) {
        centersList.innerHTML = `
            <div class="text-center py-5">
                <i class="fas fa-building fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No hay centros de práctica registrados</h4>
                <p>Agrega nuevos centros de práctica para comenzar.</p>
            </div>
        `;
        return;
    }
    
    // Tomar un subconjunto de centros para la página actual
    // En una implementación real, aplicaríamos filtros primero
    const startIndex = 0;
    const endIndex = 10; // Mostrar los primeros 10 centros por ahora
    const currentCenters = centersData.slice(startIndex, endIndex);
    
    currentCenters.forEach(center => {
        // Crear iniciales para logo
        const initials = center.nombre
            .split(' ')
            .map(word => word.charAt(0))
            .join('')
            .substring(0, 2)
            .toUpperCase();
        
        // Determinar calidad
        let qualityBadge = '';
        if (center.alineacionPerfil === 'excelente' && center.relevanciaIndustria === 'alta') {
            qualityBadge = `<span class="quality-badge quality-excellent">Alta Pertinencia</span>`;
        } else if (center.alineacionPerfil === 'buena' || center.relevanciaIndustria === 'media') {
            qualityBadge = `<span class="quality-badge quality-good">Media Pertinencia</span>`;
        } else if (center.alineacionPerfil === 'suficiente' || center.relevanciaIndustria === 'baja') {
            qualityBadge = `<span class="quality-badge quality-average">Baja Pertinencia</span>`;
        } else {
            qualityBadge = `<span class="quality-badge quality-poor">Sin Evaluación</span>`;
        }
        
        // Traducir sector industrial
        let sectorText = '';
        switch(center.sector) {
            case 'mineria': sectorText = 'Minería'; break;
            case 'industria': sectorText = 'Industria manufacturera'; break;
            case 'tecnologia': sectorText = 'Tecnología'; break;
            case 'servicios': sectorText = 'Servicios'; break;
            case 'comercio': sectorText = 'Comercio'; break;
            case 'construccion': sectorText = 'Construcción'; break;
            case 'agricultura': sectorText = 'Agricultura'; break;
            case 'educacion': sectorText = 'Educación'; break;
            case 'salud': sectorText = 'Salud'; break;
            case 'publico': sectorText = 'Sector público'; break;
            default: sectorText = 'Otro';
        }
        
        // Contar número de carreras pertinentes
        const carrerasCount = center.carrerasPertinentes ? center.carrerasPertinentes.length : 0;
        
        // Determinar número de impacto
        let impactDots = '';
        if (center.impactoEstrategico === 'alto') {
            impactDots = `
                <div class="impact-dots">
                    <div class="impact-dot active"></div>
                    <div class="impact-dot active"></div>
                    <div class="impact-dot active"></div>
                </div>
            `;
        } else if (center.impactoEstrategico === 'medio') {
            impactDots = `
                <div class="impact-dots">
                    <div class="impact-dot active"></div>
                    <div class="impact-dot active"></div>
                    <div class="impact-dot"></div>
                </div>
            `;
        } else {
            impactDots = `
                <div class="impact-dots">
                    <div class="impact-dot active"></div>
                    <div class="impact-dot"></div>
                    <div class="impact-dot"></div>
                </div>
            `;
        }
        
        // Renderizar tarjeta
        const card = document.createElement('div');
        card.className = 'center-card';
        card.innerHTML = `
            <div class="card-header">
                <span>Centro de Práctica</span>
                ${qualityBadge}
            </div>
            <div class="card-body">
                <div class="center-info">
                    <div class="center-logo">
                        ${initials}
                    </div>
                    <div class="center-details">
                        <div class="center-name">${center.nombre}</div>
                        <div class="center-industry">${sectorText}</div>
                        <div class="mt-1">
                            <i class="fas fa-map-marker-alt me-2 text-danger"></i>
                            ${center.ciudad}, ${center.region.charAt(0).toUpperCase() + center.region.slice(1)}
                        </div>
                        <div class="mt-1">
                            <i class="fas fa-graduation-cap me-2 text-primary"></i>
                            ${carrerasCount} carrera${carrerasCount !== 1 ? 's' : ''} pertinente${carrerasCount !== 1 ? 's' : ''}
                        </div>
                        <div class="impact-indicator mt-2">
                            <span class="text-muted me-2">Impacto estratégico:</span>
                            ${impactDots}
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-edit view-center" data-id="${center.id}">
                        <i class="fas fa-eye"></i> Ver detalles
                    </button>
                    <button class="btn btn-primary edit-center" data-id="${center.id}">
                        <i class="fas fa-edit"></i> Editar información
                    </button>
                    <button class="btn btn-secondary add-feedback" data-id="${center.id}" data-name="${center.nombre}">
                        <i class="fas fa-comment-dots"></i> Agregar retroalimentación
                    </button>
                </div>
            </div>
        `;
        
        centersList.appendChild(card);
    });
}

// Función para renderizar la lista de retroalimentación UAC → Centros
function renderUACFeedbackList() {
    const uacFeedbackList = document.getElementById('uacFeedbackList');
    uacFeedbackList.innerHTML = '';
    
    const uacFeedbacks = feedbackData.filter(fb => fb.tipo === 'uac');
    
    if (uacFeedbacks.length === 0) {
        uacFeedbackList.innerHTML = `
            <div class="text-center py-5">
                <i class="fas fa-comments fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No hay retroalimentaciones registradas</h4>
                <p>Utiliza el botón "Nueva Retroalimentación" para comenzar.</p>
            </div>
        `;
        return;
    }
    
    uacFeedbacks.forEach(feedback => {
        // Determinar clase de valoración
        let ratingClass = '';
        switch(feedback.valoracion) {
            case 'excelente': ratingClass = 'text-success'; break;
            case 'bueno': ratingClass = 'text-primary'; break;
            case 'suficiente': ratingClass = 'text-warning'; break;
            case 'deficiente': ratingClass = 'text-orange'; break;
            case 'malo': ratingClass = 'text-danger'; break;
            default: ratingClass = '';
        }
        
        // Traducir categoría
        let categoryText = '';
        switch(feedback.categoria) {
            case 'infraestructura': categoryText = 'Infraestructura'; break;
            case 'supervision': categoryText = 'Supervisión y Tutoría'; break;
            case 'aprendizaje': categoryText = 'Oportunidades de Aprendizaje'; break;
            case 'ambiente': categoryText = 'Ambiente Laboral'; break;
            case 'pertinencia': categoryText = 'Pertinencia Académica'; break;
            case 'comunicacion': categoryText = 'Comunicación'; break;
            case 'general': categoryText = 'Evaluación General'; break;
            default: categoryText = feedback.categoria;
        }
        
        // Crear tarjeta de retroalimentación
        const card = document.createElement('div');
        card.className = 'feedback-card';
        card.innerHTML = `
            <div class="feedback-header">
                <div class="feedback-title">
                    <i class="fas fa-building me-2"></i> ${feedback.centroNombre}
                </div>
                <div class="feedback-date">
                    <i class="far fa-calendar-alt me-1"></i> ${feedback.fecha}
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-md-6">
                    <strong>Categoría:</strong> ${categoryText}
                </div>
                <div class="col-md-6">
                    <strong>Valoración:</strong> <span class="${ratingClass}">${feedback.valoracion.charAt(0).toUpperCase() + feedback.valoracion.slice(1)}</span>
                </div>
            </div>
            <div class="feedback-content">
                ${feedback.comentarios}
            </div>
            ${feedback.sugerencias ? `
                <div class="mt-2">
                    <strong>Sugerencias:</strong> ${feedback.sugerencias}
                </div>
            ` : ''}
            ${feedback.seguimiento ? `
                <div class="mt-2">
                    <strong>Seguimiento:</strong> ${feedback.seguimiento}
                </div>
            ` : ''}
            <div class="feedback-actions mt-3">
                <button class="btn btn-sm btn-outline-primary edit-feedback" data-id="${feedback.id}" data-type="uac">
                    <i class="fas fa-edit me-1"></i> Editar
                </button>
                <button class="btn btn-sm btn-outline-danger delete-feedback" data-id="${feedback.id}" data-type="uac">
                    <i class="fas fa-trash-alt me-1"></i> Eliminar
                </button>
            </div>
        `;
        
        uacFeedbackList.appendChild(card);
    });
}

// Función para renderizar la lista de retroalimentación Centro → UAC
function renderCenterFeedbackList() {
    const centerFeedbackList = document.getElementById('centerFeedbackList');
    centerFeedbackList.innerHTML = '';
    
    const centerFeedbacks = feedbackData.filter(fb => fb.tipo === 'centro');
    
    if (centerFeedbacks.length === 0) {
        centerFeedbackList.innerHTML = `
            <div class="text-center py-5">
                <i class="fas fa-building fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No hay retroalimentaciones recibidas</h4>
                <p>Utiliza el botón "Solicitar Retroalimentación" para enviar solicitudes a los centros.</p>
            </div>
        `;
        return;
    }
    
    centerFeedbacks.forEach(feedback => {
        // Crear tarjeta de retroalimentación con estilos específicos para centros
        const card = document.createElement('div');
        card.className = 'feedback-card';
        card.style.borderLeft = '4px solid #17a2b8';
        card.innerHTML = `
            <div class="feedback-header">
                <div class="feedback-title">
                    <i class="fas fa-building me-2"></i> ${feedback.centroNombre}
                </div>
                <div class="feedback-date">
                    <i class="far fa-calendar-alt me-1"></i> ${feedback.fecha}
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-md-6">
                    <strong>Categoría:</strong> ${feedback.categoria.charAt(0).toUpperCase() + feedback.categoria.slice(1)}
                </div>
                <div class="col-md-6">
                    <strong>Valoración:</strong> ${feedback.valoracion.charAt(0).toUpperCase() + feedback.valoracion.slice(1)}
                </div>
            </div>
            <div class="feedback-content">
                ${feedback.comentarios}
            </div>
            ${feedback.sugerencias ? `
                <div class="mt-2">
                    <strong>Sugerencias:</strong> ${feedback.sugerencias}
                </div>
            ` : ''}
            <div class="feedback-actions mt-3">
                <button class="btn btn-sm btn-outline-primary view-feedback" data-id="${feedback.id}" data-type="centro">
                    <i class="fas fa-eye me-1"></i> Ver completo
                </button>
                <button class="btn btn-sm btn-outline-success respond-feedback" data-id="${feedback.id}" data-type="centro">
                    <i class="fas fa-reply me-1"></i> Responder
                </button>
            </div>
        `;
        
        centerFeedbackList.appendChild(card);
    });
}

// Función para renderizar la lista de retroalimentación de estudiantes
function renderStudentFeedbackList() {
    const studentFeedbackList = document.getElementById('studentFeedbackList');
    studentFeedbackList.innerHTML = '';
    
    const studentFeedbacks = feedbackData.filter(fb => fb.tipo === 'estudiante');
    
    if (studentFeedbacks.length === 0) {
        studentFeedbackList.innerHTML = `
            <div class="text-center py-5">
                <i class="fas fa-user-graduate fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No hay evaluaciones de estudiantes</h4>
                <p>Utiliza el botón "Solicitar Evaluación" para enviar solicitudes a los estudiantes.</p>
            </div>
        `;
        return;
    }
    
    studentFeedbacks.forEach(feedback => {
        // Crear tarjeta de retroalimentación con estilos específicos para estudiantes
        const card = document.createElement('div');
        card.className = 'feedback-card';
        card.style.borderLeft = '4px solid #28a745';
        card.innerHTML = `
            <div class="feedback-header">
                <div class="feedback-title">
                    <i class="fas fa-user-graduate me-2"></i> ${feedback.estudianteNombre} - ${feedback.centroNombre}
                </div>
                <div class="feedback-date">
                    <i class="far fa-calendar-alt me-1"></i> ${feedback.fecha}
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-md-6">
                    <strong>Categoría:</strong> ${feedback.categoria.charAt(0).toUpperCase() + feedback.categoria.slice(1)}
                </div>
                <div class="col-md-6">
                    <strong>Valoración:</strong> ${feedback.valoracion.charAt(0).toUpperCase() + feedback.valoracion.slice(1)}
                </div>
            </div>
            <div class="feedback-content">
                ${feedback.comentarios}
            </div>
            ${feedback.sugerencias ? `
                <div class="mt-2">
                    <strong>Sugerencias:</strong> ${feedback.sugerencias}
                </div>
            ` : ''}
            <div class="feedback-actions mt-3">
                <button class="btn btn-sm btn-outline-primary view-feedback" data-id="${feedback.id}" data-type="estudiante">
                    <i class="fas fa-eye me-1"></i> Ver completo
                </button>
                <button class="btn btn-sm btn-outline-secondary share-feedback" data-id="${feedback.id}">
                    <i class="fas fa-share-alt me-1"></i> Compartir con centro
                </button>
            </div>
        `;
        
        studentFeedbackList.appendChild(card);
    });
}

// Función para renderizar la paginación
function renderPagination() {
    const pagination = document.getElementById('pagination');
    pagination.innerHTML = '';
    
    if (totalPages <= 1) {
        return;
    }
    
    // Botón anterior
    const prevLi = document.createElement('li');
    prevLi.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
    prevLi.innerHTML = `
        <a class="page-link" href="#" aria-label="Anterior">
            <span aria-hidden="true">&laquo;</span>
        </a>
    `;
    if (currentPage > 1) {
        prevLi.addEventListener('click', (e) => {
            e.preventDefault();
            currentPage--;
            renderStudentsList();
        });
    }
    pagination.appendChild(prevLi);
    
    // Páginas
    const maxPagesToShow = 5;
    let startPage = Math.max(1, currentPage - Math.floor(maxPagesToShow / 2));
    const endPage = Math.min(totalPages, startPage + maxPagesToShow - 1);
    
    if (endPage - startPage + 1 < maxPagesToShow) {
        startPage = Math.max(1, endPage - maxPagesToShow + 1);
    }
    
    for (let i = startPage; i <= endPage; i++) {
        const pageLi = document.createElement('li');
        pageLi.className = `page-item ${i === currentPage ? 'active' : ''}`;
        pageLi.innerHTML = `<a class="page-link" href="#">${i}</a>`;
        pageLi.addEventListener('click', (e) => {
            e.preventDefault();
            currentPage = i;
            renderStudentsList();
        });
        pagination.appendChild(pageLi);
    }
    
    // Botón siguiente
    const nextLi = document.createElement('li');
    nextLi.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
    nextLi.innerHTML = `
        <a class="page-link" href="#" aria-label="Siguiente">
            <span aria-hidden="true">&raquo;</span>
        </a>
    `;
    if (currentPage < totalPages) {
        nextLi.addEventListener('click', (e) => {
            e.preventDefault();
            currentPage++;
            renderStudentsList();
        });
    }
    pagination.appendChild(nextLi);
}

// Función para actualizar las estadísticas de estudiantes
function updateStatistics() {
    let totalStudents = studentsData.length;
    let inProgress = 0;
    let completed = 0;
    let pending = 0;
    
    studentsData.forEach(student => {
        if (student.finalizacionPractica === 'en-proceso') {
            inProgress++;
        } else if (student.finalizacionPractica === 'completada') {
            completed++;
        } else {
            pending++;
        }
    });
    
    // Actualizar números
     document.getElementById('totalStudentsValue').textContent = totalStudents;
    document.getElementById('inProgressValue').textContent = inProgress;
    document.getElementById('completedValue').textContent = completed;
    document.getElementById('pendingValue').textContent = pending;
    
    // Actualizar barras de progreso
    document.getElementById('inProgressBar').style.width = totalStudents ? `${(inProgress / totalStudents) * 100}%` : '0%';
    document.getElementById('completedBar').style.width = totalStudents ? `${(completed / totalStudents) * 100}%` : '0%';
    document.getElementById('pendingBar').style.width = totalStudents ? `${(pending / totalStudents) * 100}%` : '0%';
}

// Función para actualizar las estadísticas de centros
function updateCentersStatistics() {
    const totalCenters = centersData.length;
    
    // Contar centros de alta pertinencia
    const highQualityCenters = centersData.filter(center => 
        center.alineacionPerfil === 'excelente' && center.relevanciaIndustria === 'alta'
    ).length;
    
    // Contar alianzas estratégicas (centros con impacto estratégico alto)
    const strategicCenters = centersData.filter(center => 
        center.impactoEstrategico === 'alto'
    ).length;
    
    // Contar regiones únicas
    const uniqueRegions = new Set(centersData.map(center => center.region)).size;
    
    // Actualizar valores en el dashboard
    document.getElementById('totalCentersValue').textContent = totalCenters;
    document.getElementById('highQualityValue').textContent = highQualityCenters;
    document.getElementById('strategicValue').textContent = strategicCenters;
    document.getElementById('regionsValue').textContent = uniqueRegions;
    
    // Actualizar estadísticas estratégicas
    updateStrategicIndicators();
}

// Función para actualizar indicadores estratégicos
function updateStrategicIndicators() {
    // Estos serían cálculos basados en datos reales
    // Por ahora establecemos valores de ejemplo
    
    // Tasa de colocación (estudiantes en prácticas vs postulantes)
    const placementRate = 85; // 85% de colocación
    document.getElementById('placementRateValue').textContent = `${placementRate}%`;
    document.getElementById('placementRateBar').style.width = `${placementRate}%`;
    
    // Tasa de empleabilidad post-práctica
    const employabilityRate = 42; // 42% contratados después de la práctica
    document.getElementById('employabilityValue').textContent = `${employabilityRate}%`;
    document.getElementById('employabilityBar').style.width = `${employabilityRate}%`;
    
    // Satisfacción general
    const satisfactionRate = 92; // 92% de satisfacción
    document.getElementById('satisfactionValue').textContent = `${satisfactionRate}%`;
    document.getElementById('satisfactionBar').style.width = `${satisfactionRate}%`;
    
    // Número de alianzas formales
    const allianceCount = centersData.filter(center => 
        center.impactoEstrategico === 'alto' && center.potencialColaboracion === 'alto'
    ).length;
    document.getElementById('allianceCountValue').textContent = allianceCount;
    
    // Crear gráficos estratégicos
    createStrategicCharts();
    
    // Generar recomendaciones estratégicas
    generateStrategicRecommendations();
}

// Función para configurar el selector visual de carrera en el filtro
function setupFilterCareerOptions() {
    const filterCareerOptions = document.getElementById('filterCareerOptions');
    filterCareerOptions.innerHTML = '<div class="filter-career-option selected" data-value="">Todas las carreras</div>';
    
    // Crear un conjunto de carreras únicas
    const uniqueCareers = [...new Set(studentsData.map(student => student.carrera))];
    uniqueCareers.forEach(career => {
        const option = document.createElement('div');
        option.className = 'filter-career-option';
        option.dataset.value = career;
        option.textContent = career;
        filterCareerOptions.appendChild(option);
    });
}

// Función para llenar el selector visual de carrera
function fillCareerSelector(selector, optionsList, selectedValue = '') {
    optionsList.innerHTML = '';
    
    carreras.forEach(carrera => {
        const option = document.createElement('div');
        option.className = 'career-option-item';
        option.dataset.value = carrera;
        option.textContent = carrera;
        
        if (carrera === selectedValue) {
            option.classList.add('selected');
            selector.querySelector('.career-options-btn').textContent = carrera;
            selector.classList.add('selected');
        }
        
        optionsList.appendChild(option);
    });
}

// Función para llenar el selector visual de sede
function fillCampusSelector(container, selectedValue = '') {
    container.innerHTML = '';
    
    // Determinar un nombre único para el grupo de radio buttons
    const radioGroupName = container.id === 'campusOptions' ? 'campus-option' : 'new-campus-option';
    
    sedes.forEach((sede, index) => {
        const option = document.createElement('div');
        option.className = 'campus-option-item';
        option.innerHTML = `
            <input type="radio" name="${radioGroupName}" id="${radioGroupName}-${sede}" value="${sede}" ${sede === selectedValue ? 'checked' : ''}>
            <label for="${radioGroupName}-${sede}">${sede}</label>
        `;
        container.appendChild(option);
    });
    
    // Añadir event listeners a los radios
    container.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const parentSelector = this.closest('.campus-selector');
            const hiddenInput = parentSelector.querySelector('input[type="hidden"]') || 
                                (container.id === 'campusOptions' ? document.getElementById('studentCampus') : 
                                                                   document.getElementById('studentCampus')); // Ajuste para consistencia
            
            if (hiddenInput) {
                hiddenInput.value = this.value;
                
                // Actualizar encargado de práctica
                const carrera = container.id === 'campusOptions' ? 
                    document.getElementById('studentCareer').value : 
                    document.getElementById('studentCareer').value; // Ajuste para consistencia
                
                const tipoEncargado = obtenerEncargadoPractica(carrera, this.value);
                
                if (container.id === 'campusOptions') {
                    document.querySelector(`input[name="practiceSupervisorType"][value="${tipoEncargado}"]`).checked = true;
                    document.getElementById('practiceSupervisor').value = tipoEncargado;
                } else {
                    document.querySelector(`input[name="practiceSupervisorType"][value="${tipoEncargado}"]`).checked = true;
                    document.getElementById('practiceSupervisor').value = tipoEncargado;
                }
            }
        });
    });
}

// Función para cargar centros en selectores
function loadCentersIntoSelects() {
    // Select de centro de práctica en modal de estudiante
    const practiceCenterSelect = document.getElementById('practiceCenter');
    practiceCenterSelect.innerHTML = '<option value="" disabled selected>Seleccionar centro</option>';
    
    // Select de centro para retroalimentación
    const feedbackCenterSelect = document.getElementById('feedbackCenter');
    feedbackCenterSelect.innerHTML = '<option value="" disabled selected>Seleccionar centro</option>';
    
    // Select de centro para solicitud de retroalimentación
    const requestCenterSelect = document.getElementById('requestCenter');
    requestCenterSelect.innerHTML = '<option value="" disabled selected>Seleccionar centro</option>';
    
    // Selects para filtros de retroalimentación
    const filterUacFeedbackCenter = document.getElementById('filterUacFeedbackCenter');
    filterUacFeedbackCenter.innerHTML = '<option value="">Todos los centros</option>';
    
    const filterStudentFeedbackCenter = document.getElementById('filterStudentFeedbackCenter');
    filterStudentFeedbackCenter.innerHTML = '<option value="">Todos los centros</option>';
    
    // Llenar opciones
    centersData.forEach(center => {
        const option = document.createElement('option');
        option.value = center.id;
        option.textContent = center.nombre;
        
        practiceCenterSelect.appendChild(option.cloneNode(true));
        feedbackCenterSelect.appendChild(option.cloneNode(true));
        requestCenterSelect.appendChild(option.cloneNode(true));
        filterUacFeedbackCenter.appendChild(option.cloneNode(true));
        filterStudentFeedbackCenter.appendChild(option.cloneNode(true));
    });
    
    // Llenar relevantCareers en modal de centro
    const relevantCareers = document.getElementById('relevantCareers');
    relevantCareers.innerHTML = '';
    
    carreras.forEach(carrera => {
        const option = document.createElement('option');
        option.value = carrera;
        option.textContent = carrera;
        relevantCareers.appendChild(option);
    });
}

// Función para inicializar mapas
function initializeMaps() {
    // Inicializar mapa principal de centros
    centersMap = L.map('centersMap').setView([-33.45, -70.67], 5); // Vista centrada en Chile
    
    // Añadir capa de OpenStreetMap
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(centersMap);
    
    // Crear grupo de clusters para marcadores
    markerClusterGroup = L.markerClusterGroup();
    
    // Añadir marcadores para cada centro
    centersData.forEach(center => {
        if (center.latitud && center.longitud) {
            // Determinar color del marcador según pertinencia
            let markerColor = 'red'; // Por defecto rojo (sin evaluación)
            
            if (center.alineacionPerfil === 'excelente' && center.relevanciaIndustria === 'alta') {
                markerColor = 'green'; // Alta pertinencia
            } else if (center.alineacionPerfil === 'buena' || center.relevanciaIndustria === 'media') {
                markerColor = 'blue'; // Media pertinencia
            } else if (center.alineacionPerfil === 'suficiente' || center.relevanciaIndustria === 'baja') {
                markerColor = 'orange'; // Baja pertinencia
            }
            
            // Crear ícono personalizado
            const markerIcon = L.divIcon({
                className: 'custom-div-icon',
                html: `<div style="background-color: ${markerColor}; width: 15px; height: 15px; border-radius: 50%; border: 2px solid white;"></div>`,
                iconSize: [15, 15],
                iconAnchor: [7, 7]
            });
            
            // Crear marcador
            const marker = L.marker([center.latitud, center.longitud], {
                icon: markerIcon,
                title: center.nombre
            });
            
            // Añadir popup con información
            marker.bindPopup(`
                <div class="map-tooltip">
                    <div class="map-tooltip-title">${center.nombre}</div>
                    <div class="map-tooltip-content">
                        <p><strong>Sector:</strong> ${center.sector.charAt(0).toUpperCase() + center.sector.slice(1)}</p>
                        <p><strong>Ubicación:</strong> ${center.ciudad}, ${center.region.charAt(0).toUpperCase() + center.region.slice(1)}</p>
                        <p><a href="#" onclick="showCenterDetails(${center.id}); return false;">Ver detalles</a></p>
                    </div>
                </div>
            `);
            
            // Añadir al grupo de clusters
            markerClusterGroup.addLayer(marker);
        }
    });
    
    // Añadir grupo de clusters al mapa
    centersMap.addLayer(markerClusterGroup);
    
    // Actualizar mapa después de cambio de tamaño
    setTimeout(() => {
        centersMap.invalidateSize();
    }, 500);
}

// Función para inicializar el mapa de ubicación en modal de centro
function initializeCenterLocationMap() {
    if (centerLocationMap) {
        centerLocationMap.remove(); // Limpiar mapa anterior
    }
    
    // Inicializar mapa
    centerLocationMap = L.map('centerLocationMap').setView([-33.45, -70.67], 12); // Vista inicial en Santiago
    
    // Añadir capa de OpenStreetMap
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(centerLocationMap);
    
    // Añadir marcador inicial
    const centerMarker = L.marker([-33.45, -70.67], {
        draggable: true
    }).addTo(centerLocationMap);
    
    // Actualizar coordenadas al mover el marcador
    centerMarker.on('dragend', function(e) {
        const position = centerMarker.getLatLng();
        document.getElementById('centerLatitude').value = position.lat;
        document.getElementById('centerLongitude').value = position.lng;
    });
    
    // Actualizar mapa después de cambio de tamaño
    setTimeout(() => {
        centerLocationMap.invalidateSize();
    }, 500);
    
    // Evento para buscar ubicación
    document.getElementById('searchLocationBtn').addEventListener('click', function() {
        const address = document.getElementById('centerAddress').value;
        
        if (address) {
            // En una implementación real, aquí usaríamos una API de geocodificación
            // Por simplicidad, simulamos una búsqueda exitosa
            
            // Coordenadas aleatorias cerca de Santiago
            const lat = -33.45 + (Math.random() - 0.5) * 0.1;
            const lng = -70.67 + (Math.random() - 0.5) * 0.1;
            
            // Actualizar marcador y mapa
            centerMarker.setLatLng([lat, lng]);
            centerLocationMap.setView([lat, lng], 14);
            
            // Actualizar campos ocultos
            document.getElementById('centerLatitude').value = lat;
            document.getElementById('centerLongitude').value = lng;
        }
    });
}

// Función para crear gráficos estratégicos
function createStrategicCharts() {
    // Gráfico de distribución por sector industrial
    if (sectorDistributionChart) sectorDistributionChart.destroy();
    const sectorCtx = document.getElementById('sectorDistributionChart').getContext('2d');
    sectorDistributionChart = new Chart(sectorCtx, {
        type: 'pie',
        data: {
            labels: ['Minería', 'Tecnología', 'Industria', 'Servicios', 'Construcción', 'Otros'],
            datasets: [{
                data: [30, 25, 15, 12, 10, 8],
                backgroundColor: [
                    '#4e73df', '#1cc88a', '#36b9cc', '#f6c23e', '#e74a3b', '#858796'
                ]
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'right'
                }
            }
        }
    });
    
    // Gráfico de distribución por nivel de pertinencia
    if (relevanceDistributionChart) relevanceDistributionChart.destroy();
    const relevanceCtx = document.getElementById('relevanceDistributionChart').getContext('2d');
    relevanceDistributionChart = new Chart(relevanceCtx, {
        type: 'doughnut',
        data: {
            labels: ['Alta', 'Media', 'Baja', 'Sin evaluación'],
            datasets: [{
                data: [40, 35, 15, 10],
                backgroundColor: [
                    '#28a745', '#17a2b8', '#ffc107', '#dc3545'
                ]
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'right'
                }
            }
        }
    });
    
    // Gráfico de distribución geográfica
    if (geographicDistributionChart) geographicDistributionChart.destroy();
    const geoCtx = document.getElementById('geographicDistributionChart').getContext('2d');
    geographicDistributionChart = new Chart(geoCtx, {
        type: 'bar',
        data: {
            labels: ['Metropolitana', 'Valparaíso', 'Biobío', 'O\'Higgins', 'Antofagasta', 'Otras'],
            datasets: [{
                label: 'Centros por región',
                data: [45, 20, 15, 10, 7, 3],
                backgroundColor: '#4e73df'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0
                    }
                }
            }
        }
    });
    
    // Gráfico de evolución temporal
    if (temporalEvolutionChart) temporalEvolutionChart.destroy();
    const temporalCtx = document.getElementById('temporalEvolutionChart').getContext('2d');
    temporalEvolutionChart = new Chart(temporalCtx, {
        type: 'line',
        data: {
            labels: ['2021', '2022', '2023', '2024', '2025'],
            datasets: [
                {
                    label: 'Centros de práctica',
                    data: [35, 42, 50, 65, 75],
                    borderColor: '#4e73df',
                    backgroundColor: 'rgba(78, 115, 223, 0.1)',
                    fill: true,
                    tension: 0.3
                },
                {
                    label: 'Alianzas estratégicas',
                    data: [5, 8, 12, 18, 25],
                    borderColor: '#1cc88a',
                    backgroundColor: 'rgba(28, 200, 138, 0.1)',
                    fill: true,
                    tension: 0.3
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top'
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0
                    }
                }
            }
        }
    });
}

// Función para generar recomendaciones estratégicas
function generateStrategicRecommendations() {
    // En una implementación real, estas recomendaciones se basarían en análisis de datos
    // Por ahora usamos ejemplos estáticos
    
    // Centros de alta prioridad
    const highPriorityCentersList = document.getElementById('highPriorityCentersList');
    highPriorityCentersList.innerHTML = '';
    
    const priorityCenters = centersData
        .filter(center => center.impactoEstrategico === 'alto' && center.potencialColaboracion === 'alto')
        .slice(0, 3); // Tomar los primeros 3
    
    if (priorityCenters.length > 0) {
        const priorityList = document.createElement('ul');
        priorityList.className = 'list-group';
        
        priorityCenters.forEach(center => {
            const item = document.createElement('li');
            item.className = 'list-group-item d-flex justify-content-between align-items-center';
            item.innerHTML = `
                <div>
                    <strong>${center.nombre}</strong><br>
                    <small>${center.ciudad}, ${center.region.charAt(0).toUpperCase() + center.region.slice(1)}</small>
                </div>
                <button class="btn btn-sm btn-outline-primary view-center" data-id="${center.id}">
                    <i class="fas fa-eye"></i>
                </button>
            `;
            priorityList.appendChild(item);
        });
        
        highPriorityCentersList.appendChild(priorityList);
    } else {
        highPriorityCentersList.innerHTML = `
            <div class="alert alert-light">
                No hay centros identificados como alta prioridad estratégica.
            </div>
        `;
    }
    
    // Áreas geográficas a desarrollar
    document.getElementById('geographicRecommendationsList').innerHTML = `
        <div class="alert alert-light">
            <p><strong>Regiones con baja cobertura:</strong></p>
            <ol>
                <li><strong>Aysén:</strong> 0 centros activos. Potencial en minería y energías renovables.</li>
                <li><strong>Magallanes:</strong> 1 centro activo. Oportunidades en turismo, logística y energía.</li>
                <li><strong>Atacama:</strong> 2 centros activos. Alto potencial en minería y energía solar.</li>
            </ol>
        </div>
    `;
    
    // Sectores industriales a fortalecer
    document.getElementById('industryRecommendationsList').innerHTML = `
        <div class="alert alert-light">
            <p><strong>Sectores prioritarios:</strong></p>
            <ol>
                <li><strong>Energías renovables:</strong> Sector en crecimiento con alta demanda de ingenieros.</li>
                <li><strong>Tecnologías 4.0:</strong> Automatización, IA y robótica con pocas alianzas actuales.</li>
                <li><strong>Biotecnología:</strong> Sin representación actual, relevante para carreras de ingeniería.</li>
            </ol>
        </div>
    `;
    
    // Oportunidades de colaboración
    document.getElementById('collaborationRecommendationsList').innerHTML = `
        <div class="alert alert-light">
            <p><strong>Oportunidades de colaboración:</strong></p>
            <ol>
                <li><strong>Minera Los Andes:</strong> Potencial para proyectos de investigación en sustentabilidad.</li>
                <li><strong>TechSolutions SA:</strong> Interés expresado en laboratorios conjuntos de innovación.</li>
                <li><strong>Constructora Valle Central:</strong> Posibilidad de prácticas extendidas y proyectos reales.</li>
            </ol>
        </div>
    `;
}

// Función para llenar el modal de estudiante (maneja agregar/editar)
function fillStudentModal(studentId = null) {
    const modal = document.getElementById('editStudentModal');
    const modalTitle = document.getElementById('editStudentModalLabel');
    const deleteBtn = document.getElementById('deleteStudentBtn');
    
    // Resetear formulario
    document.getElementById('editStudentForm').reset();
    
    if (studentId !== null) {
        // Modo edición
        const student = studentsData.find(s => s.id === studentId);
        if (!student) return;
        
        modalTitle.textContent = 'Editar Información del Estudiante';
        deleteBtn.style.display = 'inline-block'; // Mostrar botón de eliminar
        
        document.getElementById('studentId').value = student.id;
        document.getElementById('studentName').value = student.nombre;
        document.getElementById('studentRut').value = student.rut;
        
        // Carrera y sede
        document.getElementById('studentCareer').value = student.carrera;
        document.getElementById('studentCampus').value = student.sede;
        
        // Llenar selector visual de carrera
        fillCareerSelector(
            document.getElementById('careerSelector'),
            document.getElementById('careerOptionsList'),
            student.carrera
        );
        
        // Llenar selector visual de sede
        fillCampusSelector(
            document.getElementById('campusOptions'),
            student.sede
        );

        // Línea de investigación
        document.getElementById('researchLine').value = student.lineaInvestigacion || '';
        
        // Información de práctica
        document.getElementById('practiceSupervisor').value = student.encargadoPractica;
        
        // Seleccionar centro de práctica
        const practiceCenterSelect = document.getElementById('practiceCenter');
        const centerOption = Array.from(practiceCenterSelect.options).find(opt => opt.textContent === student.centroPractica);
        if (centerOption) centerOption.selected = true;
        
        document.getElementById('practiceInstructor').value = student.instructor;
        document.getElementById('practiceState').value = student.finalizacionPractica;
        document.getElementById('startDate').value = student.fechaInicio;
        document.getElementById('endDate').value = student.fechaTermino;
        
        // Seleccionar radios
        document.querySelector(`input[name="practiceSupervisorType"][value="${student.encargadoPractica}"]`).checked = true;
        document.querySelector(`input[name="practiceState"][value="${student.finalizacionPractica}"]`).checked = true;
        document.querySelector(`input[name="instrumentoMetodologico"][value="${student.instrumentoMetodologico || 'Informe de Practica'}"]`).checked = true;
        document.querySelector(`input[name="tracking1"][value="${student.seguimiento1}"]`).checked = true;
        document.querySelector(`input[name="partialEvaluation"][value="${student.evaluacionParcial}"]`).checked = true;
        document.querySelector(`input[name="tracking2"][value="${student.seguimiento2}"]`).checked = true;
        document.querySelector(`input[name="progressReview"][value="${student.revisionAvance}"]`).checked = true;
        document.querySelector(`input[name="instructorEvaluation"][value="${student.evaluacionInstructor}"]`).checked = true;
        document.querySelector(`input[name="examAssignment"][value="${student.asignacionHoraExamen}"]`).checked = true;
        document.querySelector(`input[name="hiringPotential"][value="${student.hiringPotential || 'baja'}"]`).checked = true;
        
        document.getElementById('instrumentoMetodologicoValue').value = student.instrumentoMetodologico || 'Informe de Practica';
        document.getElementById('finalGrade').value = student.notaFinal;
        document.getElementById('postPracticeStatus').value = student.postPracticeStatus || 'pendiente';
        document.getElementById('studentFeedback').value = student.studentFeedback || '';
        document.getElementById('instructorComments').value = student.instructorComments || '';
        
        // Documentación (botones de vista)
        document.getElementById('viewInstructorDoc').disabled = !student.documentoInstructor;
        document.getElementById('viewCompletionDoc').disabled = !student.documentoFinalizacion;
    } else {
        // Modo agregar nuevo estudiante
        modalTitle.textContent = 'Agregar Nuevo Estudiante';
        deleteBtn.style.display = 'none'; // Ocultar botón de eliminar
        
        document.getElementById('studentId').value = ''; // Sin ID para nuevo
        
        // Valores por defecto
        document.getElementById('finalGrade').value = 4.0;
        document.getElementById('postPracticeStatus').value = 'pendiente';
        
        // Llenar selectores con valores por defecto
        fillCareerSelector(
            document.getElementById('careerSelector'),
            document.getElementById('careerOptionsList'),
            carreras[0] // Carrera por defecto
        );
        fillCampusSelector(
            document.getElementById('campusOptions'),
            sedes[0] // Sede por defecto
        );
        
        // Establecer encargado por defecto basado en carrera y sede por defecto
        const tipoEncargadoDefault = obtenerEncargadoPractica(carreras[0], sedes[0]);
        document.querySelector(`input[name="practiceSupervisorType"][value="${tipoEncargadoDefault}"]`).checked = true;
        document.getElementById('practiceSupervisor').value = tipoEncargadoDefault;
        
        // Radios por defecto
        document.querySelector('input[name="practiceState"][value="no-comienza"]').checked = true;
        document.querySelector('input[name="tracking1"][value="no-comienza"]').checked = true;
        document.querySelector('input[name="partialEvaluation"][value="excelente"]').checked = true;
        document.querySelector('input[name="tracking2"][value="no-comienza"]').checked = true;
        document.querySelector('input[name="progressReview"][value="excelente"]').checked = true;
        document.querySelector('input[name="instructorEvaluation"][value="excelente"]').checked = true;
        document.querySelector('input[name="examAssignment"][value="no-comienza"]').checked = true;
        document.querySelector('input[name="instrumentoMetodologico"][value="Informe de Practica"]').checked = true;
        document.querySelector('input[name="hiringPotential"][value="baja"]').checked = true;
        
        // Deshabilitar botones de vista de documentos (nuevo estudiante no tiene docs)
        document.getElementById('viewInstructorDoc').disabled = true;
        document.getElementById('viewCompletionDoc').disabled = true;
    }
    
    // Inicializar datepickers
    flatpickr("#startDate, #endDate", {
        dateFormat: "d/m/Y",
        locale: "es",
        allowInput: true
    });
    
    // Mostrar el modal
    const editModal = new bootstrap.Modal(modal);
    editModal.show();
}

// Función para guardar los cambios de un estudiante (incluyendo agregar nuevo)
function saveStudentChanges(form) {
    const studentId = document.getElementById('studentId').value;
    const isNew = !studentId; // Si no hay ID, es nuevo
    
    // Obtener la nota final y asegurarse de que esté dentro del rango
    let notaFinal = parseFloat(document.getElementById('finalGrade').value);
    notaFinal = Math.max(1.0, Math.min(7.0, notaFinal));
    
    const carrera = document.getElementById('studentCareer').value;
    const sede = document.getElementById('studentCampus').value;
    
    // Obtener valores de los radio buttons
    const practiceState = document.querySelector('input[name="practiceState"]:checked').value;
    const tracking1 = document.querySelector('input[name="tracking1"]:checked').value;
    const partialEvaluation = document.querySelector('input[name="partialEvaluation"]:checked').value;
    const tracking2 = document.querySelector('input[name="tracking2"]:checked').value;
    const progressReview = document.querySelector('input[name="progressReview"]:checked').value;
    const instructorEvaluation = document.querySelector('input[name="instructorEvaluation"]:checked').value;
    const examAssignment = document.querySelector('input[name="examAssignment"]:checked').value;
    const instrumentoMetodologico = document.querySelector('input[name="instrumentoMetodologico"]:checked').value;
    const encargadoPractica = document.querySelector('input[name="practiceSupervisorType"]:checked').value;
    
    // Obtener centro de práctica desde el select
    const practiceCenterSelect = document.getElementById('practiceCenter');
    const selectedOption = practiceCenterSelect.options[practiceCenterSelect.selectedIndex];
    const centroPractica = selectedOption ? selectedOption.textContent : '';
    
    // Obtener valores de empleabilidad
    const hiringPotential = document.querySelector('input[name="hiringPotential"]:checked').value;
    const postPracticeStatus = document.getElementById('postPracticeStatus').value;
    const studentFeedback = document.getElementById('studentFeedback').value;
    const instructorComments = document.getElementById('instructorComments').value;
    
    // Crear objeto del estudiante
    const studentData = {
        nombre: document.getElementById('studentName').value,
        rut: document.getElementById('studentRut').value,
        carrera: carrera,
        sede: sede,
        lineaInvestigacion: document.getElementById('researchLine').value,
        encargadoPractica: encargadoPractica,
        centroPractica: centroPractica,
        instructor: document.getElementById('practiceInstructor').value,
        instrumentoMetodologico: instrumentoMetodologico,
        fechaInicio: document.getElementById('startDate').value,
        fechaTermino: document.getElementById('endDate').value,
        seguimiento1: tracking1,
        evaluacionParcial: partialEvaluation,
        seguimiento2: tracking2,
        revisionAvance: progressReview,
        evaluacionInstructor: instructorEvaluation,
        finalizacionPractica: practiceState,
        asignacionHoraExamen: examAssignment,
        notaFinal: notaFinal,
        hiringPotential: hiringPotential,
        postPracticeStatus: postPracticeStatus,
        studentFeedback: studentFeedback,
        instructorComments: instructorComments,
        documentoInstructor: false, // Inicial para nuevo
        documentoFinalizacion: false // Inicial para nuevo
    };
    
    // Manejar archivos (simulado, como en el original)
    const instructorDoc = document.getElementById('instructorDoc').files[0];
    const completionDoc = document.getElementById('completionDoc').files[0];
    
    if (instructorDoc) {
        studentData.documentoInstructor = true;
    }
    
    if (completionDoc) {
        studentData.documentoFinalizacion = true;
    }
    
    if (isNew) {
        // Agregar nuevo estudiante
        const newId = studentsData.length > 0 ? Math.max(...studentsData.map(s => s.id)) + 1 : 0;
        studentsData.push({
            id: newId,
            ...studentData
        });
        showAlert('Estudiante agregado correctamente', 'success');
    } else {
        // Editar existente
        const studentIndex = studentsData.findIndex(s => s.id === parseInt(studentId));
        if (studentIndex !== -1) {
            studentsData[studentIndex] = {
                id: parseInt(studentId),
                ...studentData
            };
            showAlert('Información del estudiante actualizada correctamente', 'success');
        } else {
            showAlert('Error al actualizar la información del estudiante', 'danger');
            return false;
        }
    }
    
    // Guardar en localStorage
    saveToLocalStorage('students');
    
    // Actualizar interfaz
    updateStatistics();
    renderStudentsList();
    setupFilterCareerOptions();
    
    return true;
}

// Función para llenar el modal de centro de práctica
function fillCenterModal(centerId = null) {
    // Limpiar formulario
    document.getElementById('centerForm').reset();
    
    // Título del modal
    const modalTitle = document.getElementById('centerModalLabel');
    
    if (centerId !== null) {
        // Edición de centro existente
        const center = centersData.find(c => c.id === centerId);
        if (!center) return;
        
        modalTitle.textContent = `Editar Centro de Práctica: ${center.nombre}`;
        
        // Llenar campos
        document.getElementById('centerId').value = center.id;
        document.getElementById('centerName').value = center.nombre;
        document.getElementById('centerIndustry').value = center.sector;
        document.getElementById('centerDescription').value = center.descripcion || '';
        document.getElementById('centerRegion').value = center.region;
        document.getElementById('centerCity').value = center.ciudad;
        document.getElementById('centerAddress').value = center.direccion;
        document.getElementById('centerLatitude').value = center.latitud || '';
        document.getElementById('centerLongitude').value = center.longitud || '';
        document.getElementById('centerContactName').value = center.contactoNombre || '';
        document.getElementById('centerContactEmail').value = center.contactoEmail || '';
        document.getElementById('centerContactPhone').value = center.contactoTelefono || '';
        document.getElementById('centerWebsite').value = center.sitioWeb || '';
        
        // Seleccionar radios de evaluación
        if (center.alineacionPerfil) {
            document.querySelector(`input[name="alignmentEvaluation"][value="${center.alineacionPerfil}"]`).checked = true;
            document.getElementById('alignmentEvaluationValue').value = center.alineacionPerfil;
        }
        
        if (center.relevanciaIndustria) {
            document.querySelector(`input[name="relevanceEvaluation"][value="${center.relevanciaIndustria}"]`).checked = true;
            document.getElementById('relevanceEvaluationValue').value = center.relevanciaIndustria;
        }
        
        if (center.calidadSupervision) {
            document.querySelector(`input[name="supervisionQuality"][value="${center.calidadSupervision}"]`).checked = true;
            document.getElementById('supervisionQualityValue').value = center.calidadSupervision;
        }
        
        if (center.infraestructura) {
            document.querySelector(`input[name="infrastructureQuality"][value="${center.infraestructura}"]`).checked = true;
            document.getElementById('infrastructureQualityValue').value = center.infraestructura;
        }
        
        // Seleccionar carreras pertinentes
        const relevantCareers = document.getElementById('relevantCareers');
        if (center.carrerasPertinentes && center.carrerasPertinentes.length > 0) {
            Array.from(relevantCareers.options).forEach(option => {
                option.selected = center.carrerasPertinentes.includes(option.value);
            });
        }
        
        // Seleccionar beneficios
        const studentBenefits = document.getElementById('studentBenefits');
        if (center.beneficiosEstudiante && center.beneficiosEstudiante.length > 0) {
            Array.from(studentBenefits.options).forEach(option => {
                option.selected = center.beneficiosEstudiante.includes(option.value);
            });
        }
        
        const uacBenefits = document.getElementById('uacBenefits');
        if (center.beneficiosUAC && center.beneficiosUAC.length > 0) {
            Array.from(uacBenefits.options).forEach(option => {
                option.selected = center.beneficiosUAC.includes(option.value);
            });
        }
        
        // Llenar campos de texto
        document.getElementById('feedbackMechanisms').value = center.mecanismosRetribucion || '';
        
        // Potencial estratégico
        if (center.impactoEstrategico) {
            document.querySelector(`input[name="strategicImpact"][value="${center.impactoEstrategico}"]`).checked = true;
            document.getElementById('strategicImpactValue').value = center.impactoEstrategico;
        }
        
        if (center.potencialColaboracion) {
            document.querySelector(`input[name="futurePotential"][value="${center.potencialColaboracion}"]`).checked = true;
            document.getElementById('futurePotentialValue').value = center.potencialColaboracion;
        }
        
        // Áreas de alianza
        const allianceAreas = document.getElementById('allianceAreas');
        if (center.areasAlianza && center.areasAlianza.length > 0) {
            Array.from(allianceAreas.options).forEach(option => {
                option.selected = center.areasAlianza.includes(option.value);
            });
        }
        
        document.getElementById('strategicObservations').value = center.observacionesEstrategicas || '';
        
        // Mostrar botón de eliminar
        document.getElementById('deleteCenterBtn').style.display = 'inline-block';
    } else {
        // Nuevo centro
        modalTitle.textContent = 'Agregar Nuevo Centro de Práctica';
        document.getElementById('centerId').value = '';
        
        // Ocultar botón de eliminar
        document.getElementById('deleteCenterBtn').style.display = 'none';
    }
    
    // Inicializar mapa de ubicación
    setTimeout(() => {
        initializeCenterLocationMap();
        
        // Si es edición y tiene coordenadas, actualizar mapa
        if (centerId !== null) {
            const center = centersData.find(c => c.id === centerId);
            if (center && center.latitud && center.longitud) {
                const marker = L.marker([center.latitud, center.longitud], {
                    draggable: true
                }).addTo(centerLocationMap);
                
                centerLocationMap.setView([center.latitud, center.longitud], 14);
                
                // Actualizar coordenadas al mover el marcador
                marker.on('dragend', function(e) {
                    const position = marker.getLatLng();
                    document.getElementById('centerLatitude').value = position.lat;
                    document.getElementById('centerLongitude').value = position.lng;
                });
            }
        }
    }, 500);
    
    // Inicializar Select2 para selects múltiples
    $(document).ready(function() {
        $('#relevantCareers, #studentBenefits, #uacBenefits, #allianceAreas').select2({
            theme: 'bootstrap-5',
            width: '100%'
        });
    });
    
    // Mostrar el modal
    const centerModal = new bootstrap.Modal(document.getElementById('centerModal'));
    centerModal.show();
}

// Función para mostrar detalles de un centro
function showCenterDetails(centerId) {
    const center = centersData.find(c => c.id === centerId);
    if (!center) return;
    
    const centerDetailsContent = document.getElementById('centerDetailsContent');
    
    // Traducir sector industrial
    let sectorText = '';
    switch(center.sector) {
        case 'mineria': sectorText = 'Minería'; break;
        case 'industria': sectorText = 'Industria manufacturera'; break;
        case 'tecnologia': sectorText = 'Tecnología'; break;
        case 'servicios': sectorText = 'Servicios'; break;
        case 'comercio': sectorText = 'Comercio'; break;
        case 'construccion': sectorText = 'Construcción'; break;
        case 'agricultura': sectorText = 'Agricultura'; break;
        case 'educacion': sectorText = 'Educación'; break;
        case 'salud': sectorText = 'Salud'; break;
        case 'publico': sectorText = 'Sector público'; break;
        default: sectorText = 'Otro';
    }
    
    // Calcular nivel de pertinencia
    let pertinenciaText = 'Sin evaluación';
    let pertinenciaClass = 'text-secondary';
    
    if (center.alineacionPerfil === 'excelente' && center.relevanciaIndustria === 'alta') {
        pertinenciaText = 'Alta Pertinencia';
        pertinenciaClass = 'text-success';
    } else if (center.alineacionPerfil === 'buena' || center.relevanciaIndustria === 'media') {
        pertinenciaText = 'Media Pertinencia';
        pertinenciaClass = 'text-primary';
    } else if (center.alineacionPerfil === 'suficiente' || center.relevanciaIndustria === 'baja') {
        pertinenciaText = 'Baja Pertinencia';
        pertinenciaClass = 'text-warning';
    }
    
    // Calcular impacto estratégico
    let impactoText = 'No evaluado';
    let impactoClass = 'text-secondary';
    
    if (center.impactoEstrategico === 'alto') {
        impactoText = 'Alto Impacto';
        impactoClass = 'text-success';
    } else if (center.impactoEstrategico === 'medio') {
        impactoText = 'Medio Impacto';
        impactoClass = 'text-primary';
    } else if (center.impactoEstrategico === 'bajo') {
        impactoText = 'Bajo Impacto';
        impactoClass = 'text-warning';
    }
    
    // Carreras pertinentes
    const carrerasText = center.carrerasPertinentes && center.carrerasPertinentes.length > 0 
        ? center.carrerasPertinentes.join(', ')
        : 'No especificadas';
    
    // Beneficios
    const beneficiosEstudiantesText = center.beneficiosEstudiante && center.beneficiosEstudiante.length > 0
        ? center.beneficiosEstudiante.map(b => {
            switch(b) {
                case 'remuneracion': return 'Remuneración económica';
                case 'alimentacion': return 'Alimentación';
                case 'transporte': return 'Transporte';
                case 'capacitacion': return 'Capacitación adicional';
                case 'empleo': return 'Posibilidad de empleo posterior';
                case 'flexibilidad': return 'Flexibilidad horaria';
                default: return 'Otros beneficios';
            }
        }).join(', ')
        : 'No especificados';
    
    const beneficiosUACText = center.beneficiosUAC && center.beneficiosUAC.length > 0
        ? center.beneficiosUAC.map(b => {
            switch(b) {
                case 'equipamiento': return 'Donación de equipamiento';
                case 'charlas': return 'Charlas/workshops';
                case 'investigacion': return 'Proyectos de investigación';
                case 'financiamiento': return 'Financiamiento académico';
                case 'capacitacion': return 'Capacitación a docentes';
                default: return 'Otros aportes';
            }
        }).join(', ')
        : 'No especificados';
    
    // Áreas de alianza
    const areasAlianzaText = center.areasAlianza && center.areasAlianza.length > 0
        ? center.areasAlianza.map(a => {
            switch(a) {
                case 'practicas': return 'Prácticas profesionales';
                case 'investigacion': return 'Investigación conjunta';
                case 'capacitacion': return 'Capacitación especializada';
                case 'proyectos': return 'Proyectos colaborativos';
                case 'infraestructura': return 'Uso compartido de infraestructura';
                case 'consultoria': return 'Consultoría';
                case 'empleabilidad': return 'Empleabilidad de egresados';
                default: return a;
            }
        }).join(', ')
        : 'No especificadas';
    
    // Generar HTML de detalles
    centerDetailsContent.innerHTML = `
        <div class="row">
            <div class="col-md-6">
                <h4 class="mb-3">${center.nombre}</h4>
                <p><strong>Sector:</strong> ${sectorText}</p>
                <p><strong>Ubicación:</strong> ${center.direccion}, ${center.ciudad}</p>
                <p><strong>Región:</strong> ${center.region.charAt(0).toUpperCase() + center.region.slice(1)}</p>
                
                <h5 class="mt-4 mb-3">Contacto</h5>
                <p><strong>Nombre:</strong> ${center.contactoNombre || 'No especificado'}</p>
                <p><strong>Email:</strong> ${center.contactoEmail || 'No especificado'}</p>
                <p><strong>Teléfono:</strong> ${center.contactoTelefono || 'No especificado'}</p>
                <p><strong>Sitio web:</strong> ${center.sitioWeb ? `<a href="${center.sitioWeb}" target="_blank">${center.sitioWeb}</a>` : 'No especificado'}</p>
            </div>
            
            <div class="col-md-6">
                <div class="mb-3">
                    <h5 class="mb-2">Nivel de pertinencia</h5>
                    <span class="h4 ${pertinenciaClass}"><i class="fas fa-certificate me-2"></i>${pertinenciaText}</span>
                </div>
                
                <div class="mb-3">
                    <h5 class="mb-2">Impacto estratégico</h5>
                    <span class="h4 ${impactoClass}"><i class="fas fa-chart-line me-2"></i>${impactoText}</span>
                </div>
                
                <div class="mb-3">
                    <strong>Alineación con perfil de egreso:</strong> 
                    <span class="badge bg-${center.alineacionPerfil === 'excelente' ? 'success' : center.alineacionPerfil === 'buena' ? 'primary' : center.alineacionPerfil === 'suficiente' ? 'warning' : center.alineacionPerfil === 'deficiente' ? 'danger' : 'secondary'}">
                        ${center.alineacionPerfil ? center.alineacionPerfil.charAt(0).toUpperCase() + center.alineacionPerfil.slice(1) : 'No evaluado'}
                    </span>
                </div>
                
                <div class="mb-3">
                    <strong>Relevancia en la industria:</strong> 
                    <span class="badge bg-${center.relevanciaIndustria === 'alta' ? 'success' : center.relevanciaIndustria === 'media' ? 'primary' : center.relevanciaIndustria === 'baja' ? 'warning' : 'secondary'}">
                        ${center.relevanciaIndustria ? center.relevanciaIndustria.charAt(0).toUpperCase() + center.relevanciaIndustria.slice(1) : 'No evaluado'}
                    </span>
                </div>
                
                <div class="mb-3">
                    <strong>Calidad de supervisión:</strong> 
                    <span class="badge bg-${center.calidadSupervision === 'excelente' ? 'success' : center.calidadSupervision === 'buena' ? 'primary' : center.calidadSupervision === 'suficiente' ? 'warning' : center.calidadSupervision === 'deficiente' ? 'danger' : 'secondary'}">
                        ${center.calidadSupervision ? center.calidadSupervision.charAt(0).toUpperCase() + center.calidadSupervision.slice(1) : 'No evaluado'}
                    </span>
                </div>
                
                <div class="mb-3">
                    <strong>Infraestructura y recursos:</strong> 
                    <span class="badge bg-${center.infraestructura === 'excelente' ? 'success' : center.infraestructura === 'buena' ? 'primary' : center.infraestructura === 'suficiente' ? 'warning' : center.infraestructura === 'deficiente' ? 'danger' : 'secondary'}">
                        ${center.infraestructura ? center.infraestructura.charAt(0).toUpperCase() + center.infraestructura.slice(1) : 'No evaluado'}
                    </span>
                </div>
            </div>
        </div>
        
        <hr class="my-4">
        
        <div class="row">
            <div class="col-md-6">
                <h5 class="mb-3">Pertinencia académica</h5>
                <p><strong>Carreras pertinentes:</strong></p>
                <p>${carrerasText}</p>
                
                <h5 class="mt-4 mb-3">Aporte y retribución</h5>
                <p><strong>Beneficios para estudiantes:</strong> ${beneficiosEstudiantesText}</p>
                <p><strong>Aporte a la UAC:</strong> ${beneficiosUACText}</p>
                <p><strong>Mecanismos de retribución:</strong> ${center.mecanismosRetribucion || 'No especificados'}</p>
            </div>
            
            <div class="col-md-6">
                <h5 class="mb-3">Potencial estratégico</h5>
                <p><strong>Potencial de colaboración futura:</strong> ${center.potencialColaboracion ? center.potencialColaboracion.charAt(0).toUpperCase() + center.potencialColaboracion.slice(1) : 'No evaluado'}</p>
                <p><strong>Áreas potenciales para alianzas:</strong> ${areasAlianzaText}</p>
                <p><strong>Observaciones estratégicas:</strong> ${center.observacionesEstrategicas || 'No hay observaciones'}</p>
                
                <div class="mini-map-container mt-3" id="detailLocationMap"></div>
            </div>
        </div>
    `;
    
    // Configurar botón de edición
    document.getElementById('editCenterBtn').onclick = function() {
        // Cerrar el modal de detalles
        const detailsModal = bootstrap.Modal.getInstance(document.getElementById('centerDetailsModal'));
        detailsModal.hide();
        
        // Abrir modal de edición
        fillCenterModal(centerId);
    };
    
    // Mostrar el modal
    const centerDetailsModal = new bootstrap.Modal(document.getElementById('centerDetailsModal'));
    centerDetailsModal.show();
    
    // Inicializar mini-mapa para la ubicación
    setTimeout(() => {
        if (center.latitud && center.longitud) {
            const detailMap = L.map('detailLocationMap').setView([center.latitud, center.longitud], 13);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(detailMap);
            
            L.marker([center.latitud, center.longitud]).addTo(detailMap);
            
            detailMap.invalidateSize();
        } else {
            document.getElementById('detailLocationMap').innerHTML = '<div class="alert alert-light text-center">No hay ubicación disponible</div>';
        }
    }, 500);
}

// Función para configurar el formulario de retroalimentación
function setupFeedbackForm(type, centerId = null, studentId = null) {
    // Resetear formulario
    document.getElementById('feedbackForm').reset();
    
    // Establecer tipo de retroalimentación
    document.getElementById('feedbackType').value = type;
    
    // Configurar título del modal
    const modalTitle = document.getElementById('feedbackModalLabel');
    switch(type) {
        case 'uac':
            modalTitle.textContent = 'Nueva Retroalimentación de UAC a Centro';
            break;
        case 'centro':
            modalTitle.textContent = 'Nueva Retroalimentación de Centro a UAC';
            break;
        case 'estudiante':
            modalTitle.textContent = 'Nueva Retroalimentación de Estudiante';
            break;
    }
    
    // Configurar secciones específicas según tipo
    document.getElementById('uacFeedbackSection').style.display = type === 'uac' ? 'block' : 'none';
    document.getElementById('studentFeedbackSection').style.display = type === 'estudiante' ? 'block' : 'none';
    
    // Si se proporciona un centerId, seleccionarlo
    if (centerId) {
        document.getElementById('feedbackCenter').value = centerId;
    }
    
    // Si se proporciona un studentId, seleccionarlo
    if (studentId) {
        document.getElementById('feedbackStudent').value = studentId;
    }
    
    // Inicializar datepicker para fecha
    flatpickr("#feedbackDate", {
        dateFormat: "d/m/Y",
        locale: "es",
        defaultDate: new Date()
    });
    
    // Mostrar el modal
    const feedbackModal = new bootstrap.Modal(document.getElementById('feedbackModal'));
    feedbackModal.show();
}

// Función para configurar el formulario de solicitud de retroalimentación
function setupRequestFeedbackForm(type) {
    // Resetear formulario
    document.getElementById('requestFeedbackForm').reset();
    
    // Establecer tipo de solicitud
    document.getElementById('requestType').value = type;
    
    // Configurar título del modal
    const modalTitle = document.getElementById('requestFeedbackModalLabel');
    
    if (type === 'centro') {
        modalTitle.textContent = 'Solicitar Retroalimentación a Centro';
        document.getElementById('requestStudentSection').style.display = 'none';
    } else {
        modalTitle.textContent = 'Solicitar Evaluación a Estudiante';
        document.getElementById('requestStudentSection').style.display = 'block';
        
        // Cargar estudiantes en el select
        const requestStudentSelect = document.getElementById('requestStudent');
        requestStudentSelect.innerHTML = '<option value="" disabled selected>Seleccionar estudiante</option>';
        
        studentsData.forEach(student => {
            const option = document.createElement('option');
            option.value = student.id;
            option.textContent = student.nombre;
            requestStudentSelect.appendChild(option);
        });
    }
    
    // Mostrar el modal
    const requestFeedbackModal = new bootstrap.Modal(document.getElementById('requestFeedbackModal'));
    requestFeedbackModal.show();
}

// Función para guardar centro de práctica
function saveCenterChanges(form) {
    const centerId = document.getElementById('centerId').value;
    
    // Obtener valores de radios
    const alignmentEvaluation = document.querySelector('input[name="alignmentEvaluation"]:checked')?.value || '';
    const relevanceEvaluation = document.querySelector('input[name="relevanceEvaluation"]:checked')?.value || '';
    const supervisionQuality = document.querySelector('input[name="supervisionQuality"]:checked')?.value || '';
    const infrastructureQuality = document.querySelector('input[name="infrastructureQuality"]:checked')?.value || '';
    const strategicImpact = document.querySelector('input[name="strategicImpact"]:checked')?.value || '';
    const futurePotential = document.querySelector('input[name="futurePotential"]:checked')?.value || '';
    
    // Obtener valores de selects múltiples
    const relevantCareersSelect = document.getElementById('relevantCareers');
    const relevantCareers = Array.from(relevantCareersSelect.selectedOptions).map(opt => opt.value);
    
    const studentBenefitsSelect = document.getElementById('studentBenefits');
    const studentBenefits = Array.from(studentBenefitsSelect.selectedOptions).map(opt => opt.value);
    
    const uacBenefitsSelect = document.getElementById('uacBenefits');
    const uacBenefits = Array.from(uacBenefitsSelect.selectedOptions).map(opt => opt.value);
    
    const allianceAreasSelect = document.getElementById('allianceAreas');
    const allianceAreas = Array.from(allianceAreasSelect.selectedOptions).map(opt => opt.value);
    
    // Crear objeto de centro
    const centerData = {
        nombre: document.getElementById('centerName').value,
        sector: document.getElementById('centerIndustry').value,
        descripcion: document.getElementById('centerDescription').value,
        region: document.getElementById('centerRegion').value,
        ciudad: document.getElementById('centerCity').value,
        direccion: document.getElementById('centerAddress').value,
        latitud: document.getElementById('centerLatitude').value,
        longitud: document.getElementById('centerLongitude').value,
        contactoNombre: document.getElementById('centerContactName').value,
        contactoEmail: document.getElementById('centerContactEmail').value,
        contactoTelefono: document.getElementById('centerContactPhone').value,
        sitioWeb: document.getElementById('centerWebsite').value,
        alineacionPerfil: alignmentEvaluation,
        relevanciaIndustria: relevanceEvaluation,
        calidadSupervision: supervisionQuality,
        infraestructura: infrastructureQuality,
        carrerasPertinentes: relevantCareers,
        beneficiosEstudiante: studentBenefits,
        beneficiosUAC: uacBenefits,
        mecanismosRetribucion: document.getElementById('feedbackMechanisms').value,
        impactoEstrategico: strategicImpact,
        potencialColaboracion: futurePotential,
        areasAlianza: allianceAreas,
        observacionesEstrategicas: document.getElementById('strategicObservations').value
    };
    
    if (centerId) {
        // Editar centro existente
        const centerIndex = centersData.findIndex(c => c.id == centerId);
        
        if (centerIndex !== -1) {
            centersData[centerIndex] = {
                ...centersData[centerIndex],
                ...centerData
            };
            
            showAlert('Centro de práctica actualizado correctamente', 'success');
        }
    } else {
        // Nuevo centro
        const newId = centersData.length > 0 
            ? Math.max(...centersData.map(c => c.id)) + 1 
            : 1;
        
        centersData.push({
            id: newId,
            ...centerData
        });
        
        showAlert('Centro de práctica agregado correctamente', 'success');
    }
    
    // Guardar en localStorage
    saveToLocalStorage('centers');
    
    // Actualizar interfaz
    updateCentersStatistics();
    renderCentersList();
    initializeMaps();
    loadCentersIntoSelects();
    
    return true;
}

// Función para guardar retroalimentación
function saveFeedback(form) {
    const feedbackId = document.getElementById('feedbackId').value;
    const feedbackType = document.getElementById('feedbackType').value;
    
    // Obtener centro
    const centerSelect = document.getElementById('feedbackCenter');
    const centerId = parseInt(centerSelect.value);
    const centerName = centerSelect.options[centerSelect.selectedIndex].textContent;
    
    // Obtener estudiante si es necesario
    let studentId = null;
    let studentName = null;
    
    if (feedbackType === 'estudiante') {
        const studentSelect = document.getElementById('feedbackStudent');
        studentId = parseInt(studentSelect.value);
        studentName = studentSelect.options[studentSelect.selectedIndex].textContent;
    }
    
    // Obtener valoración
    const rating = document.querySelector('input[name="feedbackRating"]:checked').value;
    
    // Crear objeto de retroalimentación
    const feedbackDataObj = {
        tipo: feedbackType,
        centroId: centerId,
        centroNombre: centerName,
        fecha: document.getElementById('feedbackDate').value,
        categoria: document.getElementById('feedbackCategory').value,
        valoracion: rating,
        comentarios: document.getElementById('feedbackComments').value,
        sugerencias: document.getElementById('feedbackSuggestions').value,
        seguimiento: feedbackType === 'uac' ? document.getElementById('feedbackFollowUp').value : '',
        archivoAdjunto: false // Simulamos que no hay archivo
    };
    
    // Añadir información del estudiante si es necesario
    if (feedbackType === 'estudiante') {
        feedbackDataObj.estudianteId = studentId;
        feedbackDataObj.estudianteNombre = studentName;
    }
    
    if (feedbackId) {
        // Editar retroalimentación existente
        const feedbackIndex = feedbackData.findIndex(f => f.id == feedbackId);
        
        if (feedbackIndex !== -1) {
            feedbackData[feedbackIndex] = {
                ...feedbackData[feedbackIndex],
                ...feedbackDataObj
            };
            
            showAlert('Retroalimentación actualizada correctamente', 'success');
        }
    } else {
        // Nueva retroalimentación
        const newId = feedbackData.length > 0 
            ? Math.max(...feedbackData.map(f => f.id)) + 1 
            : 1;
        
        feedbackData.push({
            id: newId,
            ...feedbackDataObj
        });
        
        showAlert('Retroalimentación guardada correctamente', 'success');
    }
    
    // Guardar en localStorage
    saveToLocalStorage('feedback');
    
    // Actualizar listas de retroalimentación
    renderUACFeedbackList();
    renderCenterFeedbackList();
    renderStudentFeedbackList();
    
    return true;
}

// Función para eliminar un registro
function deleteRecord(type, id) {
    switch(type) {
        case 'student':
            const studentIndex = studentsData.findIndex(s => s.id === id);
            
            if (studentIndex !== -1) {
                // Eliminar el estudiante
                studentsData.splice(studentIndex, 1);
                
                // Reasignar IDs para mantener la secuencia
                studentsData.forEach((student, index) => {
                    student.id = index;
                });
                
                // Guardar en localStorage
                saveToLocalStorage('students');
                
                // Actualizar interfaz
                updateStatistics();
                renderStudentsList();
                setupFilterCareerOptions();
                
                showAlert('Estudiante eliminado correctamente', 'success');
            } else {
                showAlert('Error al eliminar el estudiante', 'danger');
            }
            break;
        
        case 'center':
            const centerIndex = centersData.findIndex(c => c.id == id);
            
            if (centerIndex !== -1) {
                // Eliminar el centro
                centersData.splice(centerIndex, 1);
                
                // Guardar en localStorage
                saveToLocalStorage('centers');
                
                // Actualizar interfaz
                updateCentersStatistics();
                renderCentersList();
                initializeMaps();
                loadCentersIntoSelects();
                
                showAlert('Centro de práctica eliminado correctamente', 'success');
            } else {
                showAlert('Error al eliminar el centro de práctica', 'danger');
            }
            break;
        
        case 'feedback':
            const feedbackIndex = feedbackData.findIndex(f => f.id == id);
            
            if (feedbackIndex !== -1) {
                // Eliminar la retroalimentación
                feedbackData.splice(feedbackIndex, 1);
                
                // Guardar en localStorage
                saveToLocalStorage('feedback');
                
                // Actualizar listas
                renderUACFeedbackList();
                renderCenterFeedbackList();
                renderStudentFeedbackList();
                
                showAlert('Retroalimentación eliminada correctamente', 'success');
            } else {
                showAlert('Error al eliminar la retroalimentación', 'danger');
            }
            break;
    }
}

// Función para mostrar el modal de confirmación de eliminación
function showDeleteConfirmationModal(type, id, name) {
    elementIdToDelete = id;
    deleteType = type;
    
    document.getElementById('elementToDeleteName').textContent = name;
    
    const deleteConfirmModal = new bootstrap.Modal(document.getElementById('deleteConfirmModal'));
    deleteConfirmModal.show();
}

// Función para guardar en localStorage
function saveToLocalStorage(type) {
    switch(type) {
        case 'students':
            const studentsToSave = studentsData.map(student => ({
                nombre: student.nombre,
                rut: student.rut,
                carrera: student.carrera,
                sede: student.sede,
                lineaInvestigacion: student.lineaInvestigacion,
                encargadoPractica: student.encargadoPractica,
                centroPractica: student.centroPractica,
                instructor: student.instructor,
                instrumentoMetodologico: student.instrumentoMetodologico,
                fechaInicio: student.fechaInicio,
                fechaTermino: student.fechaTermino,
                seguimiento1: student.seguimiento1,
                evaluacionParcial: student.evaluacionParcial,
                seguimiento2: student.seguimiento2,
                revisionAvance: student.revisionAvance,
                evaluacionInstructor: student.evaluacionInstructor,
                finalizacionPractica: student.finalizacionPractica,
                asignacionHoraExamen: student.asignacionHoraExamen,
                notaFinal: student.notaFinal,
                hiringPotential: student.hiringPotential,
                postPracticeStatus: student.postPracticeStatus,
                studentFeedback: student.studentFeedback,
                instructorComments: student.instructorComments
            }));
            
            localStorage.setItem('datosPracticas', JSON.stringify(studentsToSave));
            break;
        
        case 'centers':
            localStorage.setItem('datosCentrosPracticas', JSON.stringify(centersData));
            break;
        
        case 'feedback':
            localStorage.setItem('datosRetroalimentacion', JSON.stringify(feedbackData));
            break;
        
        default:
            // Guardar todo
            saveToLocalStorage('students');
            saveToLocalStorage('centers');
            saveToLocalStorage('feedback');
    }
}

// Función para mostrar alertas
function showAlert(message, type) {
    const alertHTML = `
        <div class="alert alert-${type} alert-dismissible fade show position-fixed top-0 start-50 translate-middle-x mt-3" 
            role="alert" style="z-index: 1050;">
            <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} me-2"></i> ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
        </div>
    `;
    $('body').append(alertHTML);
    setTimeout(() => {
        $('.alert').alert('close');
    }, 3000);
}

// Función global para mostrar detalles de centro (accesible desde popups del mapa)
window.showCenterDetails = function(centerId) {
    showCenterDetails(parseInt(centerId));
};

// Inicialización cuando el DOM esté listo
$(document).ready(function() {
    // Verificar si el usuario está logueado (simulado)
    if (sessionStorage.getItem('loggedIn') !== 'true') {
        sessionStorage.setItem('loggedIn', 'true');
    }
    
    // Cargar datos
    loadStudentsData();
    loadCentersData();
    loadFeedbackData();
    
    // Inicializar tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
    
    // Inicializar datepickers
    flatpickr(".datepicker", {
        dateFormat: "d/m/Y",
        locale: "es",
        allowInput: true
    });
    
    // Inicializar select2 para selects múltiples
    $('.select2').select2({
        theme: 'bootstrap-5',
        width: '100%'
    });
    
    // Event listeners para filtros de estudiantes
    
    // Filtro de búsqueda
    $('#searchStudent').on('input', function() {
        activeFilters.search = $(this).val().trim();
        currentPage = 1;
        renderStudentsList();
    });
    
    // Filtro por estado (radio buttons)
    $('input[name="filterStatus"]').on('change', function() {
        activeFilters.status = $(this).val();
        currentPage = 1;
        renderStudentsList();
        updateActiveFiltersDisplay();
    });
    
    // Filtro por carrera (selector visual)
    $('#filterCareerBtn').on('click', function() {
        $('#filterCareerSelector').toggleClass('active');
    });
    
    // Cerrar selector de carrera al hacer clic fuera
    $(document).on('click', function(e) {
        if (!$(e.target).closest('#filterCareerSelector').length) {
            $('#filterCareerSelector').removeClass('active');
        }
    });
    
    // Seleccionar carrera desde el filtro
    $(document).on('click', '.filter-career-option', function() {
        const value = $(this).data('value');
        
        $('.filter-career-option').removeClass('selected');
        $(this).addClass('selected');
        
        $('#filterCareerBtn').text(value ? value : 'Todas las carreras');
        $('#filterCareer').val(value);
        
        if (value) {
            $('#filterCareerSelector').addClass('selected');
        } else {
            $('#filterCareerSelector').removeClass('selected');
        }
        
        $('#filterCareerSelector').removeClass('active');
        
        // Actualizar filtro
        activeFilters.career = value;
        currentPage = 1;
        renderStudentsList();
        updateActiveFiltersDisplay();
    });
    
    // Función para actualizar etiquetas de filtros activos
    function updateActiveFiltersDisplay() {
        const activeFiltersContainer = document.getElementById('activeFilters');
        activeFiltersContainer.innerHTML = '';
        
        if (activeFilters.career) {
            const tag = document.createElement('span');
            tag.className = 'filter-tag';
            tag.innerHTML = `Carrera: ${activeFilters.career} <i class="fas fa-times close"></i>`;
            tag.querySelector('.close').addEventListener('click', () => {
                // Resetear filtro de carrera
                $('#filterCareer').val('');
                $('#filterCareerBtn').text('Todas las carreras');
                $('#filterCareerSelector').removeClass('selected');
                $('.filter-career-option').removeClass('selected');
                $('.filter-career-option[data-value=""]').addClass('selected');
                
                activeFilters.career = '';
                currentPage = 1;
                renderStudentsList();
                updateActiveFiltersDisplay();
            });
            activeFiltersContainer.appendChild(tag);
        }
        
        if (activeFilters.status) {
            let statusText = 'Pendiente';
            if (activeFilters.status === 'en-proceso') statusText = 'En proceso';
            if (activeFilters.status === 'completada') statusText = 'Completada';
            
            const tag = document.createElement('span');
            tag.className = 'filter-tag';
            tag.innerHTML = `Estado: ${statusText} <i class="fas fa-times close"></i>`;
            tag.querySelector('.close').addEventListener('click', () => {
                // Resetear filtro de estado
                $('input[name="filterStatus"][value=""]').prop('checked', true);
                
                activeFilters.status = '';
                currentPage = 1;
                renderStudentsList();
                updateActiveFiltersDisplay();
            });
            activeFiltersContainer.appendChild(tag);
        }
    }
    
    // Event listeners para selector de carrera en modales
    $(document).on('click', '#careerOptionsBtn', function() {
        $('#careerSelector').toggleClass('active');
    });
    
    // Seleccionar carrera en modal de edición/agregar
    $(document).on('click', '#careerOptionsList .career-option-item', function() {
        const value = $(this).data('value');
        
        $('#careerOptionsList .career-option-item').removeClass('selected');
        $(this).addClass('selected');
        
        $('#careerOptionsBtn').text(value);
        $('#studentCareer').val(value);
        
        $('#careerSelector').removeClass('active').addClass('selected');
        
        // Actualizar encargado de práctica
        const sede = document.getElementById('studentCampus').value;
        const tipoEncargado = obtenerEncargadoPractica(value, sede);
        document.querySelector(`input[name="practiceSupervisorType"][value="${tipoEncargado}"]`).checked = true;
        document.getElementById('practiceSupervisor').value = tipoEncargado;
    });
    
    // Cerrar selectores de carrera al hacer clic fuera
    $(document).on('click', function(e) {
        if (!$(e.target).closest('#careerSelector').length) {
            $('#careerSelector').removeClass('active');
        }
    });
    
    // Event listeners para radios de opciones visuales en modal de edición de estudiante
    
    // Práctica
    $(document).on('change', 'input[name="practiceState"]', function() {
        document.getElementById('practiceState').value = this.value;
    });
    
    // Seguimiento 1
    $(document).on('change', 'input[name="tracking1"]', function() {
        document.getElementById('tracking1').value = this.value;
    });
    
    // Evaluación parcial
    $(document).on('change', 'input[name="partialEvaluation"]', function() {
        document.getElementById('partialEvaluation').value = this.value;
    });
    
    // Seguimiento 2
    $(document).on('change', 'input[name="tracking2"]', function() {
        document.getElementById('tracking2').value = this.value;
    });
    
    // Revisión de avance
    $(document).on('change', 'input[name="progressReview"]', function() {
        document.getElementById('progressReview').value = this.value;
    });
    
    // Evaluación instructor
    $(document).on('change', 'input[name="instructorEvaluation"]', function() {
        document.getElementById('instructorEvaluation').value = this.value;
    });
    
    // Asignación hora examen
    $(document).on('change', 'input[name="examAssignment"]', function() {
        document.getElementById('examAssignment').value = this.value;
    });
    
    // Instrumento metodológico
    $(document).on('change', 'input[name="instrumentoMetodologico"]', function() {
        document.getElementById('instrumentoMetodologicoValue').value = this.value;
    });
    
    // Encargado de práctica
    $(document).on('change', 'input[name="practiceSupervisorType"]', function() {
        document.getElementById('practiceSupervisor').value = this.value;
    });
    
    // Potencial de contratación
    $(document).on('change', 'input[name="hiringPotential"]', function() {
        document.getElementById('hiringPotentialValue').value = this.value;
    });
    
    // Event listeners para radios en modal de centro
    
    // Alineación con perfil
    $(document).on('change', 'input[name="alignmentEvaluation"]', function() {
        document.getElementById('alignmentEvaluationValue').value = this.value;
    });
    
    // Relevancia en industria
    $(document).on('change', 'input[name="relevanceEvaluation"]', function() {
        document.getElementById('relevanceEvaluationValue').value = this.value;
    });
    
    // Calidad de supervisión
    $(document).on('change', 'input[name="supervisionQuality"]', function() {
        document.getElementById('supervisionQualityValue').value = this.value;
    });
    
    // Infraestructura
    $(document).on('change', 'input[name="infrastructureQuality"]', function() {
        document.getElementById('infrastructureQualityValue').value = this.value;
    });
    
    // Impacto estratégico
    $(document).on('change', 'input[name="strategicImpact"]', function() {
        document.getElementById('strategicImpactValue').value = this.value;
    });
    
    // Potencial futuro
    $(document).on('change', 'input[name="futurePotential"]', function() {
        document.getElementById('futurePotentialValue').value = this.value;
    });
    
    // Valoración en retroalimentación
    $(document).on('change', 'input[name="feedbackRating"]', function() {
        document.getElementById('feedbackRatingValue').value = this.value;
    });
    
    // Agregar estudiante nuevo
    $('#addStudentBtn').on('click', function() {
        fillStudentModal(null); // null para modo "agregar"
    });
    
    // Editar estudiante existente (CORREGIDO: ahora llama a fillStudentModal)
    $(document).on('click', '.edit-student', function() {
        const studentId = parseInt($(this).data('id'));
        fillStudentModal(studentId);
    });
    
    // Botón para eliminar estudiante
    $(document).on('click', '#deleteStudentBtn', function() {
        const studentId = parseInt($('#studentId').val());
        const studentName = document.getElementById('studentName').value;
        
        showDeleteConfirmationModal('student', studentId, studentName);
        $('#editStudentModal').modal('hide');
    });
    
    // Botón para eliminar centro
    $(document).on('click', '#deleteCenterBtn', function() {
        const centerId = document.getElementById('centerId').value;
        const centerName = document.getElementById('centerName').value;
        
        showDeleteConfirmationModal('center', centerId, centerName);
        $('#centerModal').modal('hide');
    });
    
    // Confirmar eliminación
    $('#confirmDeleteBtn').on('click', function() {
        if (elementIdToDelete !== null && deleteType !== null) {
            deleteRecord(deleteType, elementIdToDelete);
            $('#deleteConfirmModal').modal('hide');
            elementIdToDelete = null;
            deleteType = null;
        }
    });
    
    // Envío del formulario de edición/agregar de estudiante
    $('#editStudentForm').on('submit', function(e) {
        e.preventDefault();
        if (saveStudentChanges(this)) {
            $('#editStudentModal').modal('hide');
        }
    });
    
    // Envío del formulario de centro
    $('#centerForm').on('submit', function(e) {
        e.preventDefault();
        if (saveCenterChanges(this)) {
            $('#centerModal').modal('hide');
        }
    });
    
    // Envío del formulario de retroalimentación
    $('#feedbackForm').on('submit', function(e) {
        e.preventDefault();
        if (saveFeedback(this)) {
            $('#feedbackModal').modal('hide');
        }
    });
    
    // Envío del formulario de solicitud de retroalimentación
    $('#requestFeedbackForm').on('submit', function(e) {
        e.preventDefault();
        // Aquí se implementaría la lógica real para enviar solicitudes
        showAlert('Solicitud enviada correctamente', 'success');
        $('#requestFeedbackModal').modal('hide');
    });
    
    // Agregar centro de práctica
    $('#addCenterBtn').on('click', function() {
        fillCenterModal();
    });
    
    // Ver detalles de centro
    $(document).on('click', '.view-center', function() {
        const centerId = parseInt($(this).data('id'));
        showCenterDetails(centerId);
    });
    
    // Editar centro
    $(document).on('click', '.edit-center', function() {
        const centerId = parseInt($(this).data('id'));
        fillCenterModal(centerId);
    });
    
    // Nueva retroalimentación UAC → Centro
    $('#newUacFeedbackBtn').on('click', function() {
        setupFeedbackForm('uac');
    });
    
    // Agregar retroalimentación desde tarjeta de centro
    $(document).on('click', '.add-feedback', function() {
        const centerId = parseInt($(this).data('id'));
        setupFeedbackForm('uac', centerId);
    });
    
    // Solicitar retroalimentación a centro
    $('#requestCenterFeedbackBtn').on('click', function() {
        setupRequestFeedbackForm('centro');
    });
    
    // Solicitar evaluación a estudiante
    $('#requestStudentFeedbackBtn').on('click', function() {
        setupRequestFeedbackForm('estudiante');
    });
    
    // Editar retroalimentación
    $(document).on('click', '.edit-feedback', function() {
        const feedbackId = parseInt($(this).data('id'));
        const feedbackType = $(this).data('type');
        
        // Aquí se implementaría la lógica para cargar datos en el modal
        setupFeedbackForm(feedbackType);
        document.getElementById('feedbackId').value = feedbackId;
    });
    
    // Eliminar retroalimentación
    $(document).on('click', '.delete-feedback', function() {
        const feedbackId = parseInt($(this).data('id'));
        
        // Aquí obtendríamos el nombre o título de la retroalimentación
        showDeleteConfirmationModal('feedback', feedbackId, 'esta retroalimentación');
    });
    
    // Cambio de pestaña principal
    $('#mainTabs button').on('click', function(e) {
        if ($(this).attr('id') === 'centers-tab') {
            // Actualizar el mapa cuando se cambia a la pestaña de centros
            setTimeout(() => {
                if (centersMap) {
                    centersMap.invalidateSize();
                }
            }, 100);
        }
    });
    
    // Filtros para centros de práctica
    $('#searchCenter, #filterQuality, #filterImpact').on('input change', function() {
        // Aquí se implementaría el filtrado de centros
        renderCentersList();
    });
    
    // Filtro por sector industrial
    $('#industryFilter input[type="checkbox"]').on('change', function() {
        const isAllChecked = $('#industryAll').prop('checked');
        
        if (this.id === 'industryAll' && isAllChecked) {
            // Si se selecciona "Todos", desmarcar los demás
            $('#industryFilter input[type="checkbox"]').not('#industryAll').prop('checked', false);
        } else if (this.id !== 'industryAll' && this.checked) {
            // Si se selecciona algún sector específico, desmarcar "Todos"
            $('#industryAll').prop('checked', false);
        }
        
        // Si no hay ningún sector seleccionado, marcar "Todos"
        if ($('#industryFilter input[type="checkbox"]:checked').length === 0) {
            $('#industryAll').prop('checked', true);
        }
        
        // Actualizar lista de centros
        renderCentersList();
    });
    
    // Botón para cerrar sesión
    $('#logoutBtn').on('click', function() {
        sessionStorage.removeItem('loggedIn');
        window.location.href = 'index.html';
    });
    
    // Botón para volver al menú principal
    $('#volverPrincipal, .navbar-brand').on('click', function(e) {
        e.preventDefault();
        window.location.href = 'index.html';
    });
});
    </script>
</body>
</html>
